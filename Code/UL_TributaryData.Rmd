---
title: "UtahLake_TributaryData"
author: "Kateri Salk"
output:
  html_document: default
  pdf_document: default
editor_options:
  chunk_output_type: console
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(lubridate)
library(viridis)
library(wqTools)
library(sf)
library(tmap)
library(cowplot)
library(openxlsx)
library(dataRetrieval)

theme_set(theme_classic())
options(scipen = 4)
```

## Details


## Load data

Data were loaded from spreadsheets obtained by Utah DWQ: 

```{r}
# tributary data
trib <- read.csv("./Data/Processed/ul_Tribdata_wqp_processed_2021-03-02.csv")
# facility data
fac <- read.csv("./Data/Processed/ul_Facilitydata_wqp_processed.csv")
# watershed spatial data
wshds <- read_sf("./Data/GIS/UL_subwshedsWGS84_v2.shp")
# sampling activity logs
activitylog <- read.csv("./Data/Processed/UL_Trib_SampleActivities_exported 12-17-20.csv")
# groundwater data
gw <- read.csv("./Data/Processed/ul_wqp_gwdata_processed_2021-01-07.csv")
# precipitation and evaporation data
p_et <- read.xlsx("./Data/Processed/ULEFDCFlowBoundaries_WY2006-2018.xlsx", 
                  sheet = "Precip-ET", startRow = 2)
# DMR data
dmr <- read.xlsx("./Data/Processed/DMR_Analysis_v3_updated 12-7-20.xlsx", 
                 sheet = "DMR.Formatted")
dmr_LUT <- read.xlsx("./Data/Processed/DMR_Analysis_v3_updated 12-7-20.xlsx", 
                     sheet = "LUT_SiteList", startRow = 2, cols = 1:5)
# Jordan River outflow hydrology
jordan_outflow <- read.xlsx("./Data/Processed/Jordan_River_Outflow.xlsx", 
                  sheet = "DailyValues20219216", startRow = 5)

# Utah lake storage capacity curve
ul_level <- read.xlsx("./Data/Processed/Copy of ULDB_Stage_Vol_SA_V3(sd-JLM).xlsm", 
                  sheet = "Time Series of Vol and SA", startRow = 11, 
                  cols = c(7:10))

# 2019 and 2020 WFWQC flow data
WFWQC_flow <- read.csv("./Data/Processed/WFWQC_Flow.csv")


```

## Data processing

### Watersheds

Watersheds were divided into monitored and unmonitored and arranged in clockwise order.

```{r}
wshds_monitored <- wshds %>%
  filter(Monitored_ == "YES") %>%
  # Dry Creek - Saratoga appears twice. Remove the instance with very very small area. 
  filter(OBJECTID_1 != 74)

wshds_monitored$WS_Name <- 
  factor(wshds_monitored$WS_Name, 
         levels = c("Tickville Wash", "Dry Creek - Saratoga", "Lehi Spring Creek", 
                    "American Fork River", "Timp SSD", "Lindon Drain", 
                    "Powell Slough Major", "Provo River", "Mill Race", 
                    "Spring Creek - Springville", "Hobble Creek", 
                    "Dry Creek - Spanish Fork", "Spanish Fork River", 
                    "4000 South Drain Spanish Fork", "Benjamin Slough", "Currant Creek"))
levels(wshds_monitored$WS_Name)

```


### Tributary data

Tributary dataset was filtered for: 

1. Variables pertaining to C, N, P, or flow (discharge)
2. Years 2010-2020

Flow data were converted to cubic feet/sec (cfs) when units originally appeared as gallon/min, cubic meters/sec, and million gallons/day.

```{r}
trib$ActivityStartDate <- as.Date(trib$ActivityStartDate)
# unique(trib$CharacteristicName)
trib$ResultMeasureValue <- as.numeric(as.character(trib$ResultMeasureValue))

trib_wq <- trib %>%
  # Set nondetects (qualifier code U) as 1/2 MDL. 
  # Qualifier code J is above detection but below reporting. Values retained as-is.
  # REVISIT: What does qualifier code Q mean? One sample for ammonium at 0.062
  mutate(ResultMeasureValue = case_when(MeasureQualifierCode == "U" ~ MethodDetectionLevel/2, 
                                        TRUE ~ ResultMeasureValue)) %>%
  filter(CharacteristicName %in% 
           c("Ammonia-nitrogen as N", "Carbon", "Nitrate as N", "Organic carbon",
             "Ammonium", "Carbonate", "Inorganic carbon", "Nitrate", "Nitrogen", 
             "Phosphorus", "Ammonia and ammonium", 
             "Inorganic nitrogen (nitrate and nitrite)", "Nitrite", "Orthophosphate", 
             "Kjeldahl nitrogen", "Nitrogen, mixed forms (NH3), (NH4), organic, (NO2) and (NO3)",
             "Organic Nitrogen", "Ammonia-nitrogen", "Phosphate-phosphorus",
             "Total Kjeldahl nitrogen")) %>%
  filter(ResultMeasure.MeasureUnitCode %in% c("ueq/L", "mg/l", "mg/l as N", "<NA>", "mg/l as P")) %>%
  select(ActivityStartDate:ResultSampleFractionText,
         OrganizationIdentifier:MonitoringLocationTypeName, LatitudeMeasure, 
         LongitudeMeasure, ResultMeasureValue, ResultMeasure.MeasureUnitCode, 
         ResultStatusIdentifier) %>%
  mutate(Month = month(ActivityStartDate), 
         Year = year(ActivityStartDate)) %>%
  filter(Year >= 2010) %>%
  droplevels() %>%
  filter(!is.na(ResultMeasureValue)) %>%
  select(-SampleDepthValue, -RelativeDepth, -ResultMeasure.MeasureUnitCode) %>%
  unite("Variable", CharacteristicName:ResultSampleFractionText) 

trib_flow <- trib %>%
  filter(CharacteristicName %in% c("Flow", "Stream flow, instantaneous", "Stream flow, mean. daily")) %>%
  droplevels() %>%
  #filter(ResultStatusIdentifier != "Provisional") %>% # can filter out provisional data
  select(ActivityStartDate:ResultSampleFractionText,
         OrganizationIdentifier:MonitoringLocationTypeName, LatitudeMeasure,
         LongitudeMeasure, ResultMeasureValue, ResultMeasure.MeasureUnitCode,
         ResultStatusIdentifier) %>%
  select(-SampleDepthValue, -RelativeDepth, -ResultSampleFractionText,
         -MonitoringLocationTypeName, -CharacteristicName) %>%
  group_by(ActivityStartDate, MonitoringLocationIdentifier, OrganizationIdentifier,
           OrganizationFormalName, MonitoringLocationName, LatitudeMeasure,
           LongitudeMeasure, ResultMeasure.MeasureUnitCode, ResultStatusIdentifier) %>%
  summarise(ResultMeasureValue = mean(ResultMeasureValue)) %>%
  mutate(Month = month(ActivityStartDate),
         Year = year(ActivityStartDate)) %>%
  filter(Year >= 2010) %>%
  droplevels() %>%
  pivot_wider(names_from = ResultMeasure.MeasureUnitCode, values_from = ResultMeasureValue) %>%
  # USGS data has both cfs and cms, always duplicated. remove cfs. 
  select(-'ft3/s')

colnames(trib_flow)[11:14] <- c("m3.sec", "cfs", "mgd", "g.min")

# convert everything to cfs
trib_flow$mgd <- trib_flow$mgd/0.646317
trib_flow$g.min <- trib_flow$g.min*0.002228017
trib_flow$m3.sec <- trib_flow$m3.sec*35.3147

trib_flow_long <- trib_flow %>%
  pivot_longer(cols = c("cfs", "mgd", "g.min", "m3.sec"), 
               names_to = "orig.units", values_to = "Flow.cfs") %>%
  drop_na(Flow.cfs)

# conversions seem to match up
ggplot(trib_flow_long, aes(x = ActivityStartDate, y = Flow.cfs, color = orig.units)) +
  geom_point(alpha = 0.5) +
  scale_y_log10() +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.8)

WFWQC_flow$ActivityStartDate <- as.Date(WFWQC_flow$ActivityStartDate)

WFWQC_flow$ResultMeasureValue[WFWQC_flow$ResultMeasureValue == "-0.153"] <- NA
WFWQC_flow$ResultMeasureValue[WFWQC_flow$ResultMeasureValue == "too deep"] <- NA
WFWQC_flow$ResultMeasureValue[WFWQC_flow$ResultMeasureValue == "no flow"] <- 0
WFWQC_flow$ResultMeasureValue <- as.numeric(WFWQC_flow$ResultMeasureValue)

flow_sites_names <- trib_wq %>%
  ungroup() %>%
  select(MonitoringLocationIdentifier, MonitoringLocationName, 
         LatitudeMeasure, LongitudeMeasure,)

WFWQC_flow_processed <- WFWQC_flow %>%
  mutate(Month = month(ActivityStartDate),
         Year = year(ActivityStartDate), 
         orig.units = "m3.sec",
         Flow.cfs = ResultMeasureValue*35.3147) %>%
  left_join(., flow_sites_names) %>%
  select(ActivityStartDate, MonitoringLocationIdentifier, OrganizationIdentifier, 
         OrganizationFormalName, MonitoringLocationName, LatitudeMeasure, 
         LongitudeMeasure, ResultStatusIdentifier, Month, Year,
         orig.units, Flow.cfs) %>%
  distinct() %>%
  drop_na(LatitudeMeasure, LongitudeMeasure)

trib_flow_long <- rbind(trib_flow_long, WFWQC_flow_processed)
```

### Find non-sampled dates

A sample type of "11" indicates a site was not sampled. A sample type of "10" indicates there was no flow. The latter should appear in the flow data as a zero; this was verified by inspecting the two datasets.

Locations and dates when sites were not sampled: 

```{r, echo = FALSE}
activitylog$Activity.Start.Date <- as.Date(activitylog$Activity.Start.Date, 
                                           "%m-%d-%Y")
activitylog_unsampled <- activitylog %>%
  filter(Activity.Start.Date > "2009-12-31") %>%
  separate(Activity.ID, into = c("SamplingRun", "MLID", "Date", "SampleType", "type"), "-") %>%
  filter(SampleType == "11") %>%
  droplevels()

unique(activitylog_unsampled$Monitoring.Location.Name)
unique(activitylog_unsampled$Activity.Start.Date)


activitylog_noflow <- activitylog %>%
  filter(Activity.Start.Date > "2009-12-31") %>%
  separate(Activity.ID, into = c("SamplingRun", "MLID", "Date", "SampleType", "type"), "-") %>%
  filter(SampleType == "10")

  
```

### Facility data

Tributary dataset was filtered for: 

1. Variables pertaining to C, N, P, or flow (discharge)
2. Years 2010-2020

Flow data were converted to cubic feet/sec (cfs) when units originally appeared as gallon/min, cubic meters/sec, and million gallons/day.

```{r}
fac$datetime <- as.POSIXct(fac$datetime)
#unique(fac$CharacteristicName)

fac_wq <- fac %>%
  # Set nondetects (qualifier code U) as 1/2 MDL. 
  # Qualifier code J is above detection but below reporting. Values retained as-is.
  # REVISIT: What does qualifier code Q mean? One sample for ammonium at 0.062
  mutate(ResultMeasureValue = case_when(MeasureQualifierCode == "U" ~ MethodDetectionLevel/2, 
                                        TRUE ~ ResultMeasureValue)) %>%
  filter(CharacteristicName %in% 
           c("Ammonia-nitrogen as N", "Carbon", "Nitrate as N", "Organic carbon",
             "Ammonium", "Carbonate", "Inorganic carbon", "Nitrate", "Nitrogen", 
             "Phosphorus", "Ammonia and ammonium", 
             "Inorganic nitrogen (nitrate and nitrite)", "Nitrite", "Orthophosphate", 
             "Kjeldahl nitrogen", "Nitrogen, mixed forms (NH3), (NH4), organic, (NO2) and (NO3)",
             "Organic Nitrogen", "Ammonia-nitrogen", "Phosphate-phosphorus",
             "Total Kjeldahl nitrogen")) %>%
  filter(ResultMeasure.MeasureUnitCode %in% c("ueq/L", "mg/l", "mg/l as N", "<NA>", "mg/l as P")) %>%
  select(MonitoringLocationIdentifier:LongitudeMeasure, ResultMeasureValue, 
         ResultMeasure.MeasureUnitCode, ResultStatusIdentifier) %>%
  mutate(Month = month(datetime), 
         Year = year(datetime)) %>%
  filter(Year >= 2010) %>%
  droplevels() %>%
  filter(!is.na(ResultMeasureValue)) %>%
  select(-SampleDepthValue, -RelativeDepth, -ResultMeasure.MeasureUnitCode) %>%
  unite("Variable", CharacteristicName:ResultSampleFractionText) 

# match date field with trib
colnames(fac_wq)[2] <- "ActivityStartDate"


fac_flow <- fac %>%
  filter(CharacteristicName == "Flow") %>%
           #c("Height, gage", "Stream flow, instantaneous", "Stream flow, mean. daily")) %>%
  droplevels() %>%
  #filter(ResultStatusIdentifier != "Provisional") %>% # can filter out provisional data
  select(MonitoringLocationIdentifier:LongitudeMeasure, ResultMeasureValue, 
         ResultMeasure.MeasureUnitCode, ResultStatusIdentifier) %>%
  select(-SampleDepthValue, -RelativeDepth, -ResultSampleFractionText, 
         -MonitoringLocationTypeName, -CharacteristicName) %>%
  group_by(MonitoringLocationIdentifier, datetime, OrganizationIdentifier, 
           OrganizationFormalName, MonitoringLocationName, LatitudeMeasure, 
           LongitudeMeasure, ResultMeasure.MeasureUnitCode, ResultStatusIdentifier) %>%
  summarise(ResultMeasureValue = mean(ResultMeasureValue)) %>%
  mutate(Month = month(datetime), 
         Year = year(datetime)) %>%
  filter(Year >= 2010) %>%
  droplevels() %>%
  pivot_wider(names_from = ResultMeasure.MeasureUnitCode, values_from = ResultMeasureValue)

fac_flow$datetime <- as.Date(fac_flow$datetime)
colnames(fac_flow)[2] <- "ActivityStartDate"

colnames(fac_flow)[11:14] <- c("mgd", "cfs", "g.min", "m3.sec")

# convert everything to cfs
fac_flow$mgd <- fac_flow$mgd/0.646317
fac_flow$g.min <- fac_flow$g.min*0.002228017
fac_flow$m3.sec <- fac_flow$m3.sec*35.3147

fac_flow_long <- fac_flow %>%
  pivot_longer(cols = c("cfs", "mgd", "g.min", "m3.sec"), 
               names_to = "orig.units", values_to = "Flow.cfs") %>%
  drop_na(Flow.cfs)

```

### Combine trib and fac data

Tributary and facility water quality and flow datasets were combined.

```{r, include = FALSE}
trib_fac_wq <- rbind(trib_wq, fac_wq)
  
trib_fac_wq <- trib_fac_wq %>%
  group_by(MonitoringLocationIdentifier, ActivityStartDate, OrganizationIdentifier,
           OrganizationFormalName, MonitoringLocationName, MonitoringLocationTypeName,
           LatitudeMeasure, LongitudeMeasure, Month, Year, Variable, 
           ResultStatusIdentifier) %>%
  summarise(ResultMeasureValue = mean(ResultMeasureValue, na.rm = TRUE)) %>%
  pivot_wider(names_from = Variable, values_from = ResultMeasureValue)

colnames(trib_fac_wq)

# .d indicates dissolved, .t indicates total.
colnames(trib_fac_wq)[12:28] <- c("NH3.d", "NH3.t", "NO23.d", "NO23.t", "TDN", 
                                  "TN", "DOC", "TOC", "TDP", "TP", "CO3.t",
                                  "TKN.t", "TKN.d", "NO3.t", "NO2.t", "PO4", "TKN.t2")

summary(trib_fac_wq)

trib_fac_flow <- rbind(trib_flow_long, fac_flow_long)
# USGS_flow <- trib_fac_flow %>%
#   filter(OrganizationIdentifier == "USGS-UT")

trib_fac_wq_flow <- full_join(trib_fac_wq, trib_fac_flow) 

```

### USGS gage data for missing discharge

 
```{r}
USGS_flow <- readNWISdv(siteNumbers = c("10153100", "10163000"),
                         parameterCd = "00060", 
                         startDate = "2010-01-01")

USGS_flow_processed <- USGS_flow %>%
  mutate(WS_Name = case_when(site_no == "10153100" ~ "Hobble Creek",
                             site_no == "10163000" ~ "Provo River")) %>%
  select(WS_Name, Date, X_00060_00003)

colnames(USGS_flow_processed) <- c("WS_Name", "ActivityStartDate", "Flow.USGS.cfs")



```

### Create spatial datasets for tributary and facility datasets

1. Intersect stations with watersheds
2. Join water quality data with intersected dataset
3. If a station is not associated with a watershed, assign it
4. Determine downstream stations in watersheds

Sites located downstream of diversion

* UTAHDWQ_WQX-4995465
* WFWQC_UT-4995467
* UTAHDWQ_WQX-4995312
* UTAHDWQ_WQX-4995578
* WFWQC_UT-4995575
* UTAHDWQ_WQX-4995578
* WFWQC_UT-4995575


Sites that may be backwatered at times

* WFWQC_UT-4917712
* WFWQC_UT-4994958
* UTAHDWQ_WQX-4995465
* WFWQC_UT-4995467
* WFWQC_UT-4996536
* UTAHDWQ_WQX-4995210
* UTAHDWQ_WQX-4995230
* WFWQC_UT-4995210
* WFWQC_UT-4995575

Intermittent sites

* UTAHDWQ_WQX-4994804
* UTAHDWQ_WQX-4994792

Effluent-dominated sites

* UTAHDWQ_WQX-4996040
* WFWQC_UT-4996040

Sites included in ULWQS SAP

* UTAHDWQ_WQX-5919910
* UTAHDWQ_WQX-4994960
* UTAHDWQ_WQX-4995465
* UTAHDWQ_WQX-4994804
* UTAHDWQ_WQX-4996040
* UTAHDWQ_WQX-4996100
* UTAHDWQ_WQX-4994792
* UTAHDWQ_WQX-4994950
* UTAHDWQ_WQX-4995120
* UTAHDWQ_WQX-4996540
* UTAHDWQ_WQX-4995210
* UTAHDWQ_WQX-4995230
* UTAHDWQ_WQX-4996680
* UTAHDWQ_WQX-4995578
* UTAHDWQ_WQX-4995041
* WFWQC_UT-4995043

```{r, message = FALSE, warning = FALSE}

trib_fac_sites <- trib_fac_wq_flow %>% 
  ungroup() %>%
  select(MonitoringLocationIdentifier, MonitoringLocationName, 
           MonitoringLocationTypeName, LatitudeMeasure, LongitudeMeasure) %>%
  distinct() %>%
  mutate(SiteType = ifelse(MonitoringLocationTypeName %in% 
                  c("Canal Drainage", "Canal Irrigation", "Canal Transport"), "Canal", 
                ifelse(MonitoringLocationTypeName %in% c("River/Stream", "Stream", "Stream: Ditch"), "Stream",
                       ifelse(MonitoringLocationTypeName %in% c("Facility Industrial", "Facility Other"), "Facility", 
                              "Storm Sewer"))))


trib_fac_sites_sf <- st_as_sf(trib_fac_sites, coords = c("LongitudeMeasure", "LatitudeMeasure"),
                              crs = 4326, dim = "XY") #CRS = WGS84


trib_fac_sites_intersect <- trib_fac_sites_sf %>%
  st_intersection(wshds) %>%
  left_join(trib_fac_wq_flow, .,) 

unique(trib_fac_sites_intersect$MonitoringLocationName[is.na(trib_fac_sites_intersect$WS_Name)])
unique(trib_fac_sites_intersect$MonitoringLocationIdentifier[is.na(trib_fac_sites_intersect$WS_Name)])
unique(trib_fac_sites_intersect$WS_Name)

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "Powell Slough WMA North Outfall to Utah Lake"] <- "Powell Slough Major"

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "Powell Slough WMA South Outfall to Utah Lake"] <- "Powell Slough Major"

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "Dry Ck Near Utah Lake-WLA"] <- "Dry Creek - Spanish Fork"

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "Mill Race at mouth 1.25 miles west of I-15"] <- "Mill Race"  

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "Hobble Creek at Utah Lake mouth"] <- "Hobble Creek"
                                 
trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "Beer Creek at Utah Lake mouth"] <- "Benjamin Slough"

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "Lindon Drain at Utah Lake Inlet"] <- "Lindon Drain"

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "Timpanogos WWTP at Utah Lake mouth"] <- "Timp SSD"
                                   
trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "American Fork River at mouth"] <- "American Fork River"
                                
trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "Unnamed flow at 4000 West @ mouth"] <- "4000 South Drain Spanish Fork"

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "JORDAN R AT UTAH L OUTLET U121 XING"] <- "Jordan River"

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "DRY CK EAST TRIBUTARY"] <- "Dry Creek - Spanish Fork"

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "Drainage Canal 0.5 mile bl I-15 at about 2500 West, Springville"] <- "Dry Creek - Spanish Fork"

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "PROVO STATION 6-WLA"] <- "Mill Race"



trib_fac_sites_wsds <- trib_fac_sites_intersect %>%
  ungroup() %>%
  select(MonitoringLocationIdentifier, OrganizationIdentifier:LongitudeMeasure, 
         SiteType:Shape_Area) %>%
  distinct() %>%
  arrange(WS_Name)
# write.csv(trib_fac_sites_wsds, file = "./Data/Processed/trib_fac_sites_initial.csv",
#           row.names = FALSE)

trib_fac_sites_counts <- trib_fac_sites_intersect %>%
  ungroup() %>%
  group_by(MonitoringLocationIdentifier, OrganizationIdentifier, OrganizationFormalName,
           MonitoringLocationName, MonitoringLocationTypeName, LatitudeMeasure,
           LongitudeMeasure, SiteType, OBJECTID_1, OBJECTID, TARGET_FID,
           Type, wsa_sqkm, WS_Name, Monitored_, WS_NAME_1, WS_NAME_12, 
           Shape_Leng, Shape_Le_1, Shape_Area) %>%
  tally() %>%
  ungroup() %>%
  select(MonitoringLocationIdentifier, n)

# trib_fac_sites_SD <- read.csv("./Data/Processed/trib_fac_sites.csv")
# 
# trib_fac_sites_combined <- full_join(trib_fac_sites_SD, trib_fac_sites_counts)
# write.csv(trib_fac_sites_combined, file = "./Data/Processed/trib_fac_sites_counts.csv",
#           row.names = FALSE)

trib_fac_sites_wsds <- trib_fac_sites_wsds %>%
  full_join(., trib_fac_sites_counts)
# write.csv(trib_fac_sites_wsds, file = "./Data/Processed/trib_fac_sites_counts.csv",
#           row.names = FALSE)

trib_fac_sites_intersect_downstream <- trib_fac_sites_intersect %>%
  filter(MonitoringLocationIdentifier %in% 
           c("UTAHDWQ_WQX-4995312", "UTAHDWQ_WQX-4995310", # Currant Creek, duplicate sites at same lat/lon
             "UTAHDWQ_WQX-4995465", "WFWQC_UT-4995467", # Benjamin Slough
             "UTAHDWQ_WQX-5919910", "WFWQC_UT-4917712", # 4000 South Drain Spanish Fork
             "UTAHDWQ_WQX-4995578", "WFWQC_UT-4995575", # Spanish Fork River
             "UTAHDWQ_WQX-4996040", "WFWQC_UT-4996040", # Dry Creek - Spanish Fork
             "UTAHDWQ_WQX-4996042", "UTAHDWQ_WQX-4996044", # Dry Creek - Spanish Fork
             "WFWQC_UT-4996100", "UTAHDWQ_WQX-4996100", "WFWQC_UT-4996096",
             "UTAHDWQ_WQX-4996275", "WFWQC_UT-4996275", # Hobble Creek
             "WFWQC_UT-4996536", "WFWQC_UT-4996540", "UTAHDWQ_WQX-4996540", "UTAHDWQ_WQX-4996566", # Mill Race
             "WFWQC_UT-4996680", "UTAHDWQ_WQX-4996680", # Provo River
             "UTAHDWQ_WQX-4995230", "WFWQC_UT-4995210", "UTAHDWQ_WQX-4995210", # Powell Slough Major
             "WFWQC_UT-4995075", "UTAHDWQ_WQX-4995120", # Lindon Drain 
             "WFWQC_UT-4995043", "UTAHDWQ_WQX-4995041", "UTAHDWQ_WQX-4995038", # Timp SSD
             "WFWQC_UT-4994958", "UTAHDWQ_WQX-4994960", # American Fork River
             "WFWQC_UT-4994948", "UTAHDWQ_WQX-4994950", #Lehi Spring Creek
             "UTAHDWQ_WQX-4994804", # Dry Creek - Saratoga
             "UTAHDWQ_WQX-4994792")) %>% #Lake Mountain - Israel Canyon
  mutate(Backwater = ifelse(MonitoringLocationIdentifier %in% 
         c("WFWQC_UT-4917712", "WFWQC_UT-4994958", "UTAHDWQ_WQX-4995465", 
           "WFWQC_UT-4995467", "WFWQC_UT-4996536", "UTAHDWQ_WQX-4995210", 
           "UTAHDWQ_WQX-4995230", "WFWQC_UT-4995210", "WFWQC_UT-4995575"), 
         "Yes", "No")) %>%
  left_join(., USGS_flow_processed)
unique(trib_fac_sites_intersect_downstream$WS_Name)

# check that flow at USGS gage is in line with measured flow at chem sites, when data exist together.
# Some cases in Spanish Fork River where measured flow was near zero but USGS flow was not. Otherwise lines up on 1:1 line.
# Will proceed to replace missing flow with USGS flow in those 
# ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name %in% 
#                 c("Hobble Creek", "Spanish Fork River", "Provo River", "Currant Creek")),
#        aes(x = Flow.cfs, y = Flow.USGS.cfs, color = WS_Name)) +
#   geom_point() +
#   geom_abline(slope = 1, intercept = 0)

trib_fac_sites_intersect_downstream$Flow.cfs[is.na(trib_fac_sites_intersect_downstream$Flow.cfs)] <-
  trib_fac_sites_intersect_downstream$Flow.USGS.cfs[is.na(trib_fac_sites_intersect_downstream$Flow.cfs)]

# remove zero flow samples from watersheds that do not go dry


# then, calculate daily loads

trib_fac_sites_intersect_downstream <- trib_fac_sites_intersect_downstream %>%
  mutate(Flow.cfs = case_when(WS_Name == "Lehi Spring Creek" & Flow.cfs == 0 ~ NA_real_, 
                              WS_Name == "Timp SSD" & OrganizationIdentifier == "WFWQC_UT" & 
                                Flow.cfs == 0 ~ NA_real_, 
                              WS_Name == "Powell Slough Major" & Flow.cfs == 0 ~ NA_real_,
                              WS_Name == "Provo River" & Flow.cfs == 0 ~ NA_real_,
                              WS_Name == "Mill Race" & Flow.cfs == 0 ~ NA_real_,
                              WS_Name == "Hobble Creek" & Flow.cfs == 0 ~ NA_real_,
                              WS_Name == "Dry Creek - Spanish Fork" & Flow.cfs == 0 ~ NA_real_,
                              WS_Name == "Spanish Fork River" & Flow.cfs == 0 ~ NA_real_,
                              WS_Name == "4000 South Drain Spanish Fork" & Flow.cfs == 0 ~ NA_real_,
                              WS_Name == "Benjamin Slough" & Flow.cfs == 0 ~ NA_real_, 
                              TRUE ~ Flow.cfs)) %>%
  mutate(load.TN.kgd = TN * Flow.cfs * 28.3168 * 86400 / 1000000, 
         load.TDN.kgd = TDN * Flow.cfs * 28.3168 * 86400 / 1000000,
         load.TP.kgd = TP * Flow.cfs * 28.3168 * 86400 / 1000000,
         load.TDP.kgd = TDP * Flow.cfs * 28.3168 * 86400 / 1000000,
         load.TOC.kgd = TOC * Flow.cfs * 28.3168 * 86400 / 1000000,
         load.DOC.kgd = DOC * Flow.cfs * 28.3168 * 86400 / 1000000)

trib_fac_sites_intersect_downstream$load.TN.kgd[trib_fac_sites_intersect_downstream$Flow.cfs == 0] <- 0
trib_fac_sites_intersect_downstream$load.TDN.kgd[trib_fac_sites_intersect_downstream$Flow.cfs == 0] <- 0
trib_fac_sites_intersect_downstream$load.TP.kgd[trib_fac_sites_intersect_downstream$Flow.cfs == 0] <- 0
trib_fac_sites_intersect_downstream$load.TDP.kgd[trib_fac_sites_intersect_downstream$Flow.cfs == 0] <- 0
trib_fac_sites_intersect_downstream$load.TOC.kgd[trib_fac_sites_intersect_downstream$Flow.cfs == 0] <- 0
trib_fac_sites_intersect_downstream$load.DOC.kgd[trib_fac_sites_intersect_downstream$Flow.cfs == 0] <- 0

trib_fac_sites_intersect_downstream$SiteType[is.na(trib_fac_sites_intersect_downstream$SiteType)] <- "Not specified"

trib_fac_sites_downstream <- trib_fac_sites_intersect_downstream %>% 
  ungroup() %>%
  select(MonitoringLocationIdentifier, MonitoringLocationName, OrganizationIdentifier,
           MonitoringLocationTypeName, LatitudeMeasure, LongitudeMeasure, WS_Name) %>%
  distinct()


trib_fac_sites_downstream_sf <- st_as_sf(trib_fac_sites_downstream, coords = c("LongitudeMeasure", "LatitudeMeasure"),
                              crs = 4326, dim = "XY") #CRS = WGS84

trib_fac_sites_downstream_sf$WS_Name <- 
  factor(trib_fac_sites_downstream_sf$WS_Name, 
         levels = c("Tickville Wash", "Dry Creek - Saratoga", "Lehi Spring Creek", 
                    "American Fork River", "Timp SSD", "Lindon Drain", 
                    "Powell Slough Major", "Provo River", "Mill Race", 
                    "Spring Creek - Springville", "Hobble Creek", 
                    "Dry Creek - Spanish Fork", "Spanish Fork River", 
                    "4000 South Drain Spanish Fork", "Benjamin Slough", "Currant Creek"))
                                                                                                                      
trib_fac_sites_intersect_downstream$WS_Name <- 
  factor(trib_fac_sites_intersect_downstream$WS_Name, 
         levels = c("Tickville Wash", "Dry Creek - Saratoga", "Lehi Spring Creek", 
                    "American Fork River", "Timp SSD", "Lindon Drain", 
                    "Powell Slough Major", "Provo River", "Mill Race", 
                    "Spring Creek - Springville", "Hobble Creek", 
                    "Dry Creek - Spanish Fork", "Spanish Fork River", 
                    "4000 South Drain Spanish Fork", "Benjamin Slough", "Currant Creek"))

# Create two datasets: one starting in 2010, one starting in 2015. The later period of record is the main dataset. 

trib_fac_sites_intersect_downstream_early <- trib_fac_sites_intersect_downstream

trib_fac_sites_intersect_downstream <- trib_fac_sites_intersect_downstream %>%
  filter(Year >= 2015)

# convert concentrations to ug/L, not mg/L
# Note: 'Total Kjeldahl nitrogen_Total' was not multiplied by 1000 due to spaces in the name. Variable not being used but will need to be corrected if things change. 
trib_fac_sites_intersect_downstream <- trib_fac_sites_intersect_downstream %>%
  mutate(NH3.d = NH3.d * 1000,
         NH3.t = NH3.t * 1000,
         NO23.d = NO23.d * 1000, 
         NO23.t = NO23.t *1000, 
         TDN = TDN * 1000, 
         TN = TN * 1000, 
         DOC = DOC * 1000,
         TOC = TOC * 1000, 
         TDP = TDP * 1000, 
         TP = TP * 1000, 
         CO3.t = CO3.t * 1000, 
         TKN.t = TKN.t * 1000, 
         TKN.d = TKN.d * 1000, 
         NO3.t = NO3.t * 1000, 
         NO2.t = NO2.t * 1000, 
         PO4 = PO4 * 1000, 
         TKN.t2 = TKN.t2 * 1000)

# There is one TP value from WFWQC of 2 ug/L, which is below the detection limit of 10 ug/L. Set to 1/2 detection limit. 
trib_fac_sites_intersect_downstream$TP[trib_fac_sites_intersect_downstream$TP == 2] <- 5

trib_fac_sites_intersect_downstream_MillRace <- trib_fac_sites_intersect_downstream %>%
  filter(WS_Name == "Mill Race") %>%
  arrange(ActivityStartDate)
# write.csv(trib_fac_sites_intersect_downstream_MillRace, 
#           file = "./Data/Processed/MillRace_WQandFlow.csv", 
#           row.names = FALSE)

# Theron Miller requested flow data. Subset that data to send to him. 
trib_fac_sites_intersect_downstream_flow <- trib_fac_sites_intersect_downstream %>%
  select(MonitoringLocationIdentifier:ResultStatusIdentifier, orig.units:Flow.cfs, WS_Name)
# write.csv(trib_fac_sites_intersect_downstream_flow,
#           file = "./Data/Processed/UL_TributaryFlow_downstreamsites.csv",
#           row.names = FALSE)

# computing proportion of flow from WFWQC, in total and for Lindon Drain and Spanish Fork
trib_fac_sites_intersect_downstream_flow_entities_TN <-
  trib_fac_sites_intersect_downstream %>%
  drop_na(Flow.cfs, TN) %>%
  group_by(OrganizationIdentifier) %>%
  summarise(n = n())
trib_fac_sites_intersect_downstream_flow_entities_TN
#   OrganizationIdentifier     n
# * <chr>                  <int>
# 1 UTAHDWQ_WQX              552
# 2 WFWQC_UT                 111

trib_fac_sites_intersect_downstream_flow_entities_TP <-
  trib_fac_sites_intersect_downstream %>%
  drop_na(Flow.cfs, TP) %>%
  group_by(OrganizationIdentifier) %>%
  summarise(n = n())
trib_fac_sites_intersect_downstream_flow_entities_TP
#   OrganizationIdentifier     n
# * <chr>                  <int>
# 1 UTAHDWQ_WQX              550
# 2 WFWQC_UT                 331

trib_fac_sites_intersect_downstream_flow_entities_LDandSF_TP <-
  trib_fac_sites_intersect_downstream %>%
  filter(WS_Name %in% c("Lindon Drain", "Spanish Fork River")) %>%
  drop_na(Flow.cfs, TP) %>%
  group_by(OrganizationIdentifier, WS_Name) %>%
  summarise(n = n())
trib_fac_sites_intersect_downstream_flow_entities_LDandSF_TP
#   OrganizationIdentifier WS_Name                n
#   <chr>                  <fct>              <int>
# 1 UTAHDWQ_WQX            Lindon Drain          38
# 2 UTAHDWQ_WQX            Spanish Fork River    31
# 3 WFWQC_UT               Lindon Drain          36
# 4 WFWQC_UT               Spanish Fork River    21


trib_fac_sites_intersect_downstream_flow_entities_LDandSF_TN <-
  trib_fac_sites_intersect_downstream %>%
  filter(WS_Name %in% c("Lindon Drain", "Spanish Fork River")) %>%
  drop_na(Flow.cfs, TN) %>%
  group_by(OrganizationIdentifier, WS_Name) %>%
  summarise(n = n())
trib_fac_sites_intersect_downstream_flow_entities_LDandSF_TN
#   OrganizationIdentifier WS_Name                n
#   <chr>                  <fct>              <int>
# 1 UTAHDWQ_WQX            Lindon Drain          38
# 2 UTAHDWQ_WQX            Spanish Fork River    31
# 3 WFWQC_UT               Lindon Drain          10
# 4 WFWQC_UT               Spanish Fork River     5
```

### Jordan River Outflow

```{r}
jordan_outflow$Date <- as.Date(jordan_outflow$Date, origin = "1899-12-30")
jordan_outflow <- jordan_outflow %>%
  select(Date, Flow)
colnames(jordan_outflow) <- c("Date", "Flow.narrows.cfs")

# if flow at the monitoring site is zero, assign value of zero to narrows. 
jordan <- trib_fac_sites_intersect %>%
  filter(MonitoringLocationIdentifier == "UTAHDWQ_WQX-4994790") %>%
  filter(Year >= 2015) %>%
  left_join(., jordan_outflow, by = c("ActivityStartDate" = "Date")) %>%
  mutate(Flow.narrows.cfs = case_when(Flow.cfs == 0 ~ Flow.cfs,
                                      TRUE ~ Flow.narrows.cfs)) %>%
    mutate(load.TN.kgd = TN * Flow.narrows.cfs * 28.3168 * 86400 / 1000000, 
         load.TDN.kgd = TDN * Flow.narrows.cfs * 28.3168 * 86400 / 1000000,
         load.TP.kgd = TP * Flow.narrows.cfs * 28.3168 * 86400 / 1000000,
         load.TDP.kgd = TDP * Flow.narrows.cfs * 28.3168 * 86400 / 1000000,
         load.TOC.kgd = TOC * Flow.narrows.cfs * 28.3168 * 86400 / 1000000,
         load.DOC.kgd = DOC * Flow.narrows.cfs * 28.3168 * 86400 / 1000000) 

# flow at the narrows is always larger than or equal to the flow measured at the monitoring station. 
ggplot(jordan, aes(x = Flow.cfs, y = Flow.narrows.cfs)) +
  geom_point() +
  geom_abline(slope = 1, intercept = 0)

jordan$load.TN.kgd[jordan$Flow.cfs == 0] <- 0
jordan$load.TDN.kgd[jordan$Flow.cfs == 0] <- 0
jordan$load.TP.kgd[jordan$Flow.cfs == 0] <- 0
jordan$load.TDP.kgd[jordan$Flow.cfs == 0] <- 0
jordan$load.TOC.kgd[jordan$Flow.cfs == 0] <- 0
jordan$load.DOC.kgd[jordan$Flow.cfs == 0] <- 0


loading_jordan <- jordan %>%
  ungroup() %>%
  group_by(WS_Name, Month) %>%
  summarise(Flow.cfs = mean(Flow.narrows.cfs, na.rm = TRUE),
            load.TN.kgd = mean(load.TN.kgd, na.rm = TRUE), 
            load.TDN.kgd = mean(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = mean(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = mean(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = mean(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = mean(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ Flow.cfs * 86400 * 31/43559.9,
                                     Month %in% c(4, 6, 9, 11) ~ Flow.cfs * 86400 * 30/43559.9,
                                     Month %in% c(2) ~ Flow.cfs * 86400 * 28/43559.9),
            load.TN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TN.kgd * 28/1000),
            load.TDN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDN.kgd * 28/1000),
            load.TP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TP.kgd * 28/1000),
            load.TDP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDP.kgd * 28/1000),
            load.TOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TOC.kgd * 28/1000),
            load.DOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.DOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.DOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.DOC.kgd * 28/1000)) %>%
  distinct() 

# temp <- data.frame(approx(loading_jordan$load.TN.kgd, n = 12))
# loading_jordan$load.TN.kgd <- temp$y
# temp <- data.frame(approx(loading_jordan$load.TDN.kgd, n = 12))
# loading_jordan$load.TDN.kgd <- temp$y
# temp <- data.frame(approx(loading_jordan$load.TP.kgd, n = 12))
# loading_jordan$load.TP.kgd <- temp$y
# temp <- data.frame(approx(loading_jordan$load.TDP.kgd, n = 12))
# loading_jordan$load.TDP.kgd <- temp$y
# temp <- data.frame(approx(loading_jordan$load.TOC.kgd, n = 12))
# loading_jordan$load.TOC.kgd <- temp$y
# temp <- data.frame(approx(loading_jordan$load.DOC.kgd, n = 12))
# loading_jordan$load.DOC.kgd <- temp$y
# 
# temp <- data.frame(approx(loading_jordan$load.TN.tonmo, n = 12))
# loading_jordan$load.TN.tonmo <- temp$y
# temp <- data.frame(approx(loading_jordan$load.TDN.tonmo, n = 12))
# loading_jordan$load.TDN.tonmo <- temp$y
# temp <- data.frame(approx(loading_jordan$load.TP.tonmo, n = 12))
# loading_jordan$load.TP.tonmo <- temp$y
# temp <- data.frame(approx(loading_jordan$load.TDP.tonmo, n = 12))
# loading_jordan$load.TDP.tonmo <- temp$y
# temp <- data.frame(approx(loading_jordan$load.TOC.tonmo, n = 12))
# loading_jordan$load.TOC.tonmo <- temp$y
# temp <- data.frame(approx(loading_jordan$load.DOC.tonmo, n = 12))
# loading_jordan$load.DOC.tonmo <- temp$y
# temp <- data.frame(approx(loading_jordan$Flow.acftmo, n = 12))
# loading_jordan$Flow.acftmo <- temp$y

loading_jordan_annual <- loading_jordan %>%
  group_by(WS_Name) %>%
  summarise(Flow.cfs = sum(Flow.cfs), 
            load.TN.tonyr = sum(load.TN.tonmo, na.rm = TRUE), 
            load.TDN.tonyr = sum(load.TDN.tonmo, na.rm = TRUE), 
            load.TP.tonyr = sum(load.TP.tonmo, na.rm = TRUE), 
            Flow.acftyr = sum(Flow.acftmo, na.rm = TRUE),
            load.TDP.tonyr = sum(load.TDP.tonmo, na.rm = TRUE), 
            load.TOC.tonyr = sum(load.TOC.tonmo, na.rm = TRUE), 
            load.DOC.tonyr = sum(load.DOC.tonmo, na.rm = TRUE))

# write.csv(loading_jordan, file = "./Data/Processed/loading_Jordan_monthly.csv",
#        row.names = FALSE)
# write.csv(loading_jordan_annual, file = "./Data/Processed/loading_Jordan_annual.csv",
#        row.names = FALSE)


```


### Groundwater (spring and well) data

```{r, include = FALSE}
gw$ActivityStartDate <- as.Date(gw$ActivityStartDate)

gw_wq_flow <- gw %>%
  # Set nondetects (qualifier code U) as 1/2 MDL.
  # Qualifier code J is above detection but below reporting. Values retained as-is.
  mutate(ResultMeasureValue = case_when(MeasureQualifierCode == "U" ~ MethodDetectionLevel/2,
                                        TRUE ~ ResultMeasureValue)) %>%
  filter(CharacteristicName %in%
           c("Ammonia-nitrogen as N", "Carbon", "Nitrate as N", "Organic carbon",
             "Ammonium", "Carbonate", "Inorganic carbon", "Nitrate", "Nitrogen",
             "Phosphorus", "Ammonia and ammonium",
             "Inorganic nitrogen (nitrate and nitrite)", "Nitrite", "Orthophosphate",
             "Kjeldahl nitrogen", "Nitrogen, mixed forms (NH3), (NH4), organic, (NO2) and (NO3)",
             "Organic Nitrogen", "Ammonia-nitrogen", "Phosphate-phosphorus",
             "Total Kjeldahl nitrogen",
             "Flow rate, instantaneous", "Flow", "Stream flow, instantaneous")) %>%
  droplevels() %>%
  filter(ResultMeasure.MeasureUnitCode %in%
           c("ft3/s", "ft3/sec", "g/min", "gal/min", "m3/sec", # flow units
             "mg/l", "mg/l as N", "mg/l as P")) %>% # chemistry units, by element not by compound
  select(MonitoringLocationIdentifier:RelativeDepth, CharacteristicName:ActivityStartDate,
         OrganizationIdentifier:MonitoringLocationTypeName, LatitudeMeasure,
         LongitudeMeasure, SampleDepthUnit, ResultMeasureValue, ResultMeasure.MeasureUnitCode,
         ResultStatusIdentifier) %>%
  mutate(Month = month(ActivityStartDate),
         Year = year(ActivityStartDate)) %>%
  filter(Year >= 2010) %>%
  droplevels() %>%
  filter(!is.na(ResultMeasureValue)) %>%
  select(-SampleDepthValue, -RelativeDepth, -ResultMeasure.MeasureUnitCode) %>%
  unite("Variable", CharacteristicName:ResultSampleFractionText) %>%
  group_by(MonitoringLocationIdentifier, ActivityStartDate, OrganizationIdentifier,
           OrganizationFormalName, MonitoringLocationName, MonitoringLocationTypeName,
           LatitudeMeasure, LongitudeMeasure, Month, Year, Variable, 
           ResultStatusIdentifier) %>%
  summarise(ResultMeasureValue = mean(ResultMeasureValue, na.rm = TRUE)) %>%
  pivot_wider(names_from = Variable, values_from = ResultMeasureValue)

colnames(gw_wq_flow)[12:25] <- c("NO23.d", "PO4", "CO3.d", "Flow.galmin", 
                                 "NO3.d", "DIN+DON", "DOC", "TDN", "NH3.d", 
                                 "NO23.t", "TP", "TDP", "NH3.t", "CO3.t")

summary(gw_wq_flow)
# ResultStatusIdentifier     NO23.d             PO4              CO3.d   
#  Length:92              Min.   :  0.020   Min.   :0.00400   Min.   :0   
#  Class :character       1st Qu.:  1.155   1st Qu.:0.01075   1st Qu.:0   
#  Mode  :character       Median :  2.220   Median :0.02050   Median :0   
#                         Mean   : 10.528   Mean   :0.02252   Mean   :0   
#                         3rd Qu.:  7.540   3rd Qu.:0.03000   3rd Qu.:0   
#                         Max.   :268.000   Max.   :0.09500   Max.   :0   
#                         NA's   :25        NA's   :12        NA's   :88  
#   Flow.galmin          NO3.d           DIN+DON            DOC        
#  Min.   :   0.21   Min.   :0.0850   Min.   :0.0900   Min.   :0.2800  
#  1st Qu.: 136.00   1st Qu.:0.4713   1st Qu.:0.2950   1st Qu.:0.2850  
#  Median :1020.00   Median :0.5780   Median :0.6300   Median :0.2900  
#  Mean   : 981.13   Mean   :0.6977   Mean   :0.6529   Mean   :0.3067  
#  3rd Qu.:1745.00   3rd Qu.:0.7740   3rd Qu.:0.8000   3rd Qu.:0.3200  
#  Max.   :2300.00   Max.   :1.6700   Max.   :1.6600   Max.   :0.3500  
#  NA's   :81        NA's   :86       NA's   :85       NA's   :89      
#       TDN             NH3.d          NO23.t               TP        
#  Min.   : 17.45   Min.   :0.09   Min.   :  0.1000   Min.   : 0.048  
#  1st Qu.: 17.60   1st Qu.:0.09   1st Qu.:  0.5633   1st Qu.: 0.048  
#  Median : 25.60   Median :0.09   Median :  1.3515   Median : 0.050  
#  Mean   : 82.81   Mean   :0.09   Mean   : 46.0040   Mean   :15.137  
#  3rd Qu.: 37.40   3rd Qu.:0.09   3rd Qu.: 36.5250   3rd Qu.:15.139  
#  Max.   :316.00   Max.   :0.09   Max.   :267.0000   Max.   :60.400  
#  NA's   :87       NA's   :91     NA's   :84         NA's   :88      
#       TDP              NH3.t         CO3.t   
#  Min.   :0.01200   Min.   :421   Min.   :0   
#  1st Qu.:0.01250   1st Qu.:421   1st Qu.:0   
#  Median :0.01300   Median :421   Median :0   
#  Mean   :0.01733   Mean   :421   Mean   :0   
#  3rd Qu.:0.02000   3rd Qu.:421   3rd Qu.:0   
#  Max.   :0.02700   Max.   :421   Max.   :0   
#  NA's   :89        NA's   :91    NA's   :89  

gw_sites <- gw_wq_flow %>%
  ungroup() %>%
  select(MonitoringLocationIdentifier, OrganizationIdentifier:LongitudeMeasure) %>%
  distinct()
  
gw_sites_sf <- st_as_sf(gw_sites, coords = c("LongitudeMeasure", "LatitudeMeasure"),
                              crs = 4326, dim = "XY") #CRS = WGS84

# EFDC/WASP output (ULEFDCFlowBoundaries_WY2006-2018) uses four zones in Utah Lake. Assign sites to one of these zones.
gw_wq_intersect <- gw_sites_sf %>%
  st_intersection(wshds) %>%
  left_join(., gw_wq_flow) %>%
  mutate(zone = case_when(WS_Name %in% 
                            c("Vineyard Drain 3", "Lehi Drain 1", "Lehi Spring Creek",
                              "Lehi Drain 2", "American Fork 2", "Skipper Bay 2", 
                              "Provo Airport", "Dry Creek - Saratoga", "American Fork 1", 
                              "Lindon Drain", "Provo River", "Tickville Wash") ~ "North", 
                          WS_Name %in% c("Benjamin Slough", "Spanish Fork River") ~ "South", 
                          WS_Name %in% c("Currant Creek", "Goshen Valley") ~ "Goshen Bay", 
                          WS_Name %in% c("Big Dry Creek", "Spring Creek - Springville") ~ "Provo Bay"), 
# TP, TDP, and PO4 measurements are always distinct (agencies may report one or the other). 
# Combine into one column.
# NO23.d is the only widely available N species. Use that to represent N.
                  TP = case_when(!is.na(PO4) ~ PO4, 
                                 !is.na(TDP) ~ TDP, 
                                 TRUE ~ TP)) %>%
  # one TP value of 60.4 (unrealistic). remove.
  filter(TP < 60) %>%
  # one NO23.d value of 268 (unrealistic). remove.
  filter(NO23.d < 250)

# Groundwater Sources	        Constant Flow (m3/sec)
# Groundwater-Northern Valley	0.997
# Groundwater-Southern Valley	0.19
# Groundwater-Goshen Bay	    0.141
# Groundwater-Provo Bay	      0.185

gw_wq_summary <- gw_wq_intersect %>%
  as.data.frame() %>%
  group_by(zone) %>%
  summarise(TP = mean(TP), 
            NO23.d = mean(NO23.d)) %>%
  mutate(Flow.m3s = case_when(zone == "North" ~ 0.997, 
                              zone == "South" ~ 0.19, 
                              zone == "Goshen Bay" ~ 0.141, 
                              zone == "Provo Bay" ~ 0.185), 
         Flow.acftyr = Flow.m3s * 31536000 / 1233.48,
         load.TP.tonyr = TP * Flow.m3s * 31536000 / 1000000, 
         load.TN.tonyr = NO23.d * Flow.m3s * 31536000 / 1000000) 
# write.csv(gw_wq_summary, file = "./Data/Processed/loading_groundwater_annual.csv", 
#           row.names = FALSE)

ggplot(gw_wq_intersect, aes(x = zone, y = TP)) +
  geom_boxplot()

ggplot(gw_wq_intersect, aes(x = zone, y = NO23.d)) +
  geom_boxplot()

  

```

### Precipitation and Evapotranspiration data


```{r, include= FALSE}

ul_level$Date <- as.Date(ul_level$Date, origin = "1899-12-30")
colnames(ul_level) <- c("Date", "Stage.m", "Volume.m3", "SurfaceArea.m2")

ul_level_processed <- ul_level %>%
  mutate(Year = year(Date), 
         Month = month(Date), 
         SurfaceArea.ac = SurfaceArea.m2/4046.86) %>%
  select(Date, Year, Month, SurfaceArea.ac) %>%
  filter(Year >= 2015) %>%
  group_by(Year, Month) %>%
  summarise(SurfaceArea.ac = mean(SurfaceArea.ac))

colnames(p_et) <- c("Date", "precip.mm", "et.mm")

p_et$Date <- as.Date(p_et$Date, origin = "1899-12-30")

p_et <- p_et %>%
  group_by(Date = floor_date(Date, unit = "1 month")) %>%
  summarise(precip.mm = sum(precip.mm), 
            et.mm = sum(et.mm)) %>%
  mutate(Year = year(Date), 
         Month = month(Date)) %>%
  filter(Year >=2015)

p_et_summary <- p_et %>%
  left_join(., ul_level_processed) %>%
  mutate(precip.acftmo = precip.mm * SurfaceArea.ac / 304.8, 
         et.acftmo = et.mm * SurfaceArea.ac / 304.8) 


p_et_monthly <- p_et_summary %>%
  group_by(Month) %>%
  summarise(precip.acftmo = mean(precip.acftmo), 
            et.acftmo = mean(et.acftmo)) 
# write.csv(p_et_monthly, file = "./Data/Processed/hydrology_precip_et_monthly.csv",
#           row.names = FALSE)



```


### DMR data

```{r}
dmr_load <- dmr %>%
  filter(perm_feature_type_desc == "External Outfall") %>%
  filter(Nuts.ParmName %in% 
           c("Nitrogen, ammonia total [as N]", "Nitrogen, Kjeldahl, total [as N]", 
             "Nitrogen, nitrate total [as N]", "Phosphate, ortho [as P]", 
             "Phosphorus, total [as P]")) %>%
  filter(Year >= 2015) %>%
  select(npdes_id, Year, Month, 
         value_type_desc, dmr_value_nmbr, dmr_unit_desc, statistical_base_short_desc,
         NPES_Name, NPDES.Type, NPDESID.Date, Nuts.ParmName, Load) %>%
  na.omit(Load) %>%
  group_by(npdes_id, Year, Month, 
           value_type_desc, dmr_value_nmbr, dmr_unit_desc, statistical_base_short_desc,
           NPES_Name, NPDES.Type, NPDESID.Date, Nuts.ParmName) %>%
  summarise(Load = mean(Load)) %>%
  ungroup() %>%
  separate(col = NPDESID.Date, into = c(NA, "Date")) %>%
  pivot_wider(names_from = "Nuts.ParmName", values_from = "Load")

dmr_load$Date <- as.Date(as.numeric(dmr_load$Date), origin = "1899-12-30")
colnames(dmr_load) <- c("NPDES.ID", "Year", "Month", "value.type", "value", 
                        "units", "stat", "NPDES.Name", "Type", "Date", 
                        "TP", "NH3", "PO4", "TKN", "NO3")

dmr_flow <- dmr %>%
  filter(perm_feature_type_desc == "External Outfall") %>%
  filter(parameter_desc =="Flow, in conduit or thru treatment plant" & 
           statistical_base_short_desc == "30DA AVG") %>%
  filter(Year >= 2015) %>%
  filter(NPES_Name %in% c("OREM CITY CORP", "PacifiCorp Energy", "PAYSON CITY CORP", 
                          "PROVO CITY CORP", "SALEM CITY CORP", "SPANISH FORK CITY CORP", 
                          "SPRINGVILLE- CITY OF", "TIMPANOGOS SPECIAL SERVICE DIS")) %>%
  select(npdes_id, Year, Month, 
         dmr_value_standard_units, statistical_base_short_desc,
         NPES_Name, NPDES.Type, NPDESID.Date) %>%
  group_by(Month, NPES_Name) %>%
  summarise(Flow.MGD = mean(dmr_value_standard_units)) 

# fill in NA values with average of all months for that location
dmr_flow$Flow.MGD[dmr_flow$NPES_Name == "OREM CITY CORP" & is.na(dmr_flow$Flow.MGD)] <-
  mean(dmr_flow$Flow.MGD[dmr_flow$NPES_Name == "OREM CITY CORP"], na.rm = TRUE)

dmr_flow$Flow.MGD[dmr_flow$NPES_Name == "PROVO CITY CORP" & is.na(dmr_flow$Flow.MGD)] <-
  mean(dmr_flow$Flow.MGD[dmr_flow$NPES_Name == "PROVO CITY CORP"], na.rm = TRUE)

dmr_flow$Flow.MGD[dmr_flow$NPES_Name == "SALEM CITY CORP" & is.na(dmr_flow$Flow.MGD)] <-
  mean(dmr_flow$Flow.MGD[dmr_flow$NPES_Name == "SALEM CITY CORP"], na.rm = TRUE)

dmr_flow <- dmr_flow %>%
  mutate(Flow.acftmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ Flow.MGD * 31 * 3.06889, 
                                 Month %in% c(4, 6, 9, 11) ~ Flow.MGD * 30 * 3.06889,
                                 Month %in% c(2) ~ Flow.MGD * 28 * 3.06889)) %>%
  arrange(NPES_Name, Month)
#write.csv(dmr_flow, file = "./Data/Processed/DMR_flow.csv", row.names = FALSE)

dmr_flow_annual <- dmr_flow %>%
  group_by(NPES_Name) %>%
  summarise(Flow.acftyr = sum(Flow.acftmo))

# PacifiCorp Energy does not report 30-day average
dmr_flow_Lindon <- dmr %>%
  filter(perm_feature_type_desc == "External Outfall") %>%
  filter(parameter_desc =="Flow, in conduit or thru treatment plant") %>%
  filter(Year >= 2015) %>%
  filter(NPES_Name %in% c("PacifiCorp Energy")) %>%
  select(npdes_id, Year, Month, 
         dmr_value_standard_units, statistical_base_short_desc,
         NPES_Name, NPDES.Type, NPDESID.Date) %>%
  drop_na() %>%
  group_by(Year, Month, NPES_Name) %>%
  summarise(Flow.MGD = round(mean(dmr_value_standard_units), digits = 2)) 
  
# # 30 day avg most available for TP
# ggplot(dmr_load, aes(x = NPDES.Name, y = TP, fill = stat)) +
#   geom_boxplot()
# 
# # 30 day avg most available for PO4
# ggplot(dmr_load, aes(x = NPDES.Name, y = PO4, fill = stat)) +
#   geom_boxplot()
# 
# # 30 day avg most available for TKN
# ggplot(dmr_load, aes(x = NPDES.Name, y = TKN, fill = stat)) +
#   geom_boxplot()
# 
# # data very limited for NO3. may want to use TKN instead.
# ggplot(dmr_load, aes(x = NPDES.Name, y = NO3, fill = stat)) +
#   geom_boxplot()
# 
# # several stats  available for NH3. may want to use TKN instead.
# ggplot(dmr_load, aes(x = NPDES.Name, y = NH3, fill = stat)) +
#   geom_boxplot()

dmr_load <- dmr_load %>%
  filter(stat == "30DA AVG") %>%
  # load is in ton/yr. convert to metric tons/mo
  mutate(TP.tonmo = TP/(12*1.10231), 
         PO4.tonmo = PO4/(12*1.10231),
         TKN.tonmo = TKN/(12*1.10231),
         NH3.tonmo = NH3/(12*1.10231),
         NO3.tonmo = NO3/(12*1.10231)) %>%
  select(-TP, -PO4, -TKN, -NH3, -NO3) %>%
  mutate(MonitoringLocationIdentifier = 
           case_when(NPDES.Name == "MCWANE DUCTILE-UTAH" ~ "UTAHDWQ_WQX-4996430", 
                     NPDES.Name == "OREM CITY CORP" ~ "UTAHDWQ_WQX-4995250",
                     NPDES.Name == "PacifiCorp Energy" ~ "UTAHDWQ_WQX-4995124",
                     NPDES.Name == "PAYSON POWER PROJECT" ~ "UTAHDWQ_WQX-4995480",
                     NPDES.Name == "PROVO CITY CORP" ~ "UTAHDWQ_WQX-4996560",
                     NPDES.Name == "SALEM CITY CORP" ~ "UTAHDWQ_WQX-4995440",
                     NPDES.Name == "SPANISH FORK CITY CORP" ~ "UTAHDWQ_WQX-4996020",
                     NPDES.Name == "SPRINGVILLE- CITY OF" ~ "UTAHDWQ_WQX-4996280",
                     NPDES.Name == "TIMPANOGOS SPECIAL SERVICE DIS" ~ "UTAHDWQ_WQX-4995040"))

dmr_sites <- dmr_load %>%
  select(NPDES.Name, MonitoringLocationIdentifier) %>%
  distinct() %>%
  left_join(., trib_fac_sites) %>%
  filter(!is.na(MonitoringLocationTypeName))

dmr_sites_sf <- st_as_sf(dmr_sites, coords = c("LongitudeMeasure", "LatitudeMeasure"),
                              crs = 4326, dim = "XY") #CRS = WGS84
dmr_sites_sf <- st_intersection(dmr_sites_sf, wshds)


```



## Visualization
### Maps

The top graph depicts all tributary and facility monitoring sites. The second graph depicts each monitored watershed individually from the NW side of the lake moving clockwise, with downstream monitoring sites marked. The third graph depicts all watersheds with only downstream monitoring sites marked.

```{r, fig.height = 8, fig.width = 8, echo = FALSE, message = FALSE}
ggplot(wshds) +
  geom_sf(aes(fill = Monitored_)) +
  geom_sf(data = trib_fac_sites_sf, aes(color = SiteType),
          alpha = 0.5) +
  scale_color_viridis_d(option = "magma", end = 0.8, direction = -1) +
  scale_fill_manual(values = c("darkgray", "lightgray"))

ggplot(wshds) +
  geom_sf(aes(fill = Monitored_)) +
  geom_sf(data = gw_sites_sf,
          alpha = 0.5) +
  scale_color_viridis_d(option = "magma", end = 0.8, direction = -1) +
  scale_fill_manual(values = c("darkgray", "lightgray"))

ggplot(wshds) +
  geom_sf(aes(fill = Monitored_)) +
  geom_sf(data = dmr_sites_sf,
          alpha = 0.5) +
  scale_color_viridis_d(option = "magma", end = 0.8, direction = -1) +
  scale_fill_manual(values = c("darkgray", "lightgray"))

# ggplot(wshds_monitored) +
#   geom_sf() +
#   geom_sf(data = trib_fac_sites_downstream_sf, aes(color = OrganizationIdentifier)) +
#   facet_wrap(~WS_Name, nrow = 3) +
#   theme(legend.position = "top")

# tm_shape(wshds_monitored) +
#   tm_polygons("wsa_sqkm")  +
#   tm_facets(by = "WS_Name")

# jitter points so they don't appear on top of each other
trib_fac_sites_downstream_sf_jitter <- st_jitter(trib_fac_sites_downstream_sf)

map.grid <- purrr::map(wshds_monitored$WS_Name,
           function(x) {
             ggplot(data = filter(wshds_monitored, WS_Name == x)) +
               geom_sf() +
               geom_sf(data = filter(trib_fac_sites_downstream_sf_jitter, WS_Name == x),
                       aes(color = OrganizationIdentifier), alpha = 0.7) +
               geom_sf(data = filter(dmr_sites_sf, WS_Name == x), color = "black") +
               scale_color_viridis_d(option = "magma", end = 0.8, begin = 0.2, direction = -1) +
               scale_x_continuous() +
               theme(legend.position = "none", title = element_text(size = 8),
                     axis.text = element_blank(), axis.ticks = element_blank()) +
               labs(title = x)
           })
plot_grid(map.grid[[15]], map.grid[[5]], map.grid[[4]], map.grid[[6]], 
          map.grid[[7]], map.grid[[8]], map.grid[[1]], map.grid[[9]], 
          map.grid[[10]], map.grid[[16]], map.grid[[12]], map.grid[[11]], 
          map.grid[[13]], map.grid[[3]], map.grid[[2]], map.grid[[14]],
          nrow = 4)
ggsave("./Code/Output/map_watershedfacet.jpg", height = 8, width = 8, units = "in")

ggplot(wshds) +
  geom_sf(aes(fill = Monitored_)) +
  geom_sf(data = trib_fac_sites_downstream_sf, aes(color = OrganizationIdentifier)) +
  geom_sf(data = dmr_sites_sf) +
  labs(fill = "Monitored", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  scale_fill_manual(values = c("darkgray", "lightgray")) +
  theme(legend.position = "top")
ggsave("./Code/Output/map_watershed.jpg", height = 6.5, width = 6.5, units = "in")

```


### Water Quality Time Series
```{r, echo = FALSE, message = FALSE, warning = FALSE}
# TN
ggplot(trib_fac_sites_intersect_downstream, 
       aes(x = ActivityStartDate, y = TN, 
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 4) +
  scale_y_log10() +
  labs(x = "", y = expression("TN ("*mu*"g/L)"), shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(ncol = 2))
ggsave("./Code/Output/TimeSeries_TNconc.jpg", width = 8, height = 6, units = "in")
  
# TDN
ggplot(trib_fac_sites_intersect_downstream, 
       aes(x = ActivityStartDate, y = TDN, 
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 4) +
  scale_y_log10() +
  labs(x = "", y = expression("TDN ("*mu*"g/L)"), shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(ncol = 2))
ggsave("./Code/Output/TimeSeries_TDNconc.jpg", width = 8, height = 6, units = "in")

# TP
ggplot(trib_fac_sites_intersect_downstream, 
       aes(x = ActivityStartDate, y = TP,
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 4) +
  scale_y_log10() +
  labs(x = "", y = expression("TP ("*mu*"g/L)"), shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(ncol = 2))
ggsave("./Code/Output/TimeSeries_TPconc.jpg", width = 8, height = 6, units = "in")

# TDP
ggplot(trib_fac_sites_intersect_downstream, 
       aes(x = ActivityStartDate, y = TDP, 
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 4) +
  scale_y_log10() +
  labs(x = "", y = expression("TDP ("*mu*"g/L)"), shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(ncol = 2))
ggsave("./Code/Output/TimeSeries_TDPconc.jpg", width = 8, height = 6, units = "in")

# TOC
ggplot(trib_fac_sites_intersect_downstream, 
       aes(x = ActivityStartDate, y = TOC, 
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 4) +
  scale_y_log10() +
  labs(x = "", y = expression("TOC ("*mu*"g/L)"), shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(ncol = 2))
ggsave("./Code/Output/TimeSeries_TOCconc.jpg", width = 8, height = 6, units = "in")

# DOC
ggplot(trib_fac_sites_intersect_downstream, 
       aes(x = ActivityStartDate, y = DOC, 
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 4) +
  scale_y_log10() +
  labs(x = "", y = expression("DOC ("*mu*"g/L)"), shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(ncol = 2))
ggsave("./Code/Output/TimeSeries_DOCconc.jpg", width = 8, height = 6, units = "in")

```


### Flow time series
```{r, echo = FALSE, message = FALSE, warning = FALSE}
ggplot(trib_fac_sites_intersect_downstream, 
       aes(x = ActivityStartDate, y = Flow.cfs, color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 4) +
  scale_y_log10() +
  labs(x = "", y = "Flow (cfs)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(ncol = 2))
ggsave("./Code/Output/TimeSeries_Flow.jpg", width = 8, height = 6, units = "in")

```

### Load time series
Note: this is an exploration, not a quantification of total load. Several watersheds have >2 sites that make up total load.
```{r, echo = FALSE, message = FALSE, warning = FALSE}
# TN
ggplot(trib_fac_sites_intersect_downstream_early, 
       aes(x = ActivityStartDate, y = load.TN.kgd, shape = SiteType,
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 4) +
  scale_y_log10() +
  labs(x = "", y = "TN load (kg/d)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(ncol = 2))
  
# TDN
ggplot(trib_fac_sites_intersect_downstream_early, 
       aes(x = ActivityStartDate, y = load.TDN.kgd, shape = SiteType,
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 4) +
  scale_y_log10() +
  labs(x = "", y = "TDN load (kg/d)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(ncol = 2))

# TP
ggplot(trib_fac_sites_intersect_downstream_early, 
       aes(x = ActivityStartDate, y = load.TP.kgd, shape = SiteType,
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 4) +
  scale_y_log10() +
  labs(x = "", y = "TP load (kg/d)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(ncol = 2))

# TDP
ggplot(trib_fac_sites_intersect_downstream_early, 
       aes(x = ActivityStartDate, y = load.TDP.kgd, shape = SiteType,
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 4) +
  scale_y_log10() +
  labs(x = "", y = "TDP load (kg/d)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(ncol = 2))

# TOC
ggplot(trib_fac_sites_intersect_downstream_early, 
       aes(x = ActivityStartDate, y = load.TOC.kgd, shape = SiteType,
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 4) +
  scale_y_log10() +
  labs(x = "", y = "TOC load (kg/d)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(ncol = 2))

# DOC
ggplot(trib_fac_sites_intersect_downstream_early, 
       aes(x = ActivityStartDate, y = load.DOC.kgd, shape = SiteType,
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 4) +
  scale_y_log10() +
  labs(x = "", y = "DOC load (kg/d)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(ncol = 2))

```

```{r}
# examine Mill race, specifically
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = ActivityStartDate, y = load.TN.kgd, 
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  scale_y_log10() +
  labs(x = "", y = "TN load (kg/d)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(ncol = 2))

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = ActivityStartDate, y = load.TP.kgd, 
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  scale_y_log10() +
  labs(x = "", y = "TP load (kg/d)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(ncol = 2))
```


```{r}
ggplot(dmr_load, aes(x = Date, y = TP.tonmo)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(NPDES.Name), nrow = 2) +
  scale_y_log10() +
  labs(y = "TP load (metric ton/mo)")

ggplot(dmr_load, aes(x = Date, y = PO4.tonmo)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(NPDES.Name), nrow = 2) +
  scale_y_log10() +
  labs(y = "TDP load (metric ton/mo)")

ggplot(dmr_load, aes(x = Date, y = TKN.tonmo)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(NPDES.Name), nrow = 2) +
  scale_y_log10() +
  labs(y = "TKN load (metric ton/mo)")


ggplot(dmr_load, aes(x = as.factor(Month), y = TP.tonmo)) +
  geom_boxplot() +
  facet_wrap(vars(NPDES.Name), nrow = 2) +
  scale_y_log10() +
  labs(y = "TP load (metric ton/mo)", x = "Month")

ggplot(dmr_load, aes(x = as.factor(Month), y = PO4.tonmo)) +
  geom_boxplot() +
  facet_wrap(vars(NPDES.Name), nrow = 2) +
  scale_y_log10() +
  labs(y = "TDP load (metric ton/mo)", x = "Month")

ggplot(dmr_load, aes(x = as.factor(Month), y = TKN.tonmo)) +
  geom_boxplot() +
  facet_wrap(vars(NPDES.Name), nrow = 2) +
  scale_y_log10() +
  labs(y = "TKN load (metric ton/mo)", x = "Month")

```

### Monthly loads by watershed

```{r, include = FALSE}
# code to generate sample sizes 
give.n <- function(x){
   return(c(y = (max(x) + 0.2*(max(x))), label = length(x)))
}
```

#### Tickville Wash

There is only one inflow monitored in Tickville Wash. Estimates are based on this site.

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Tickville Wash"),
       aes(x = as.factor(Month), y = load.TN.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Tickville Wash"),
       aes(x = as.factor(Month), y = load.TDN.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Tickville Wash"),
       aes(x = as.factor(Month), y = load.TP.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Tickville Wash"),
       aes(x = as.factor(Month), y = load.TDP.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Tickville Wash"),
       aes(x = as.factor(Month), y = load.TOC.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Tickville Wash"),
       aes(x = as.factor(Month), y = load.DOC.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

#### Dry Creek - Saratoga

There is only one inflow monitored in Dry Creek - Saratoga. Estimates are based on this site.

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = load.TN.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = load.TDN.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = load.TP.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = load.TDP.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = load.TOC.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = load.DOC.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```


#### Lehi Spring Creek

There are two sites in Lehi Spring Creek. DWQ site is upstream of WFWQC site. Will compare loads to determine if the estimates can be combined.

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = load.TN.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = load.TDN.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = load.TP.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = load.TDP.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = load.TOC.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = load.DOC.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

#### American Fork River

There are two sites in American Fork River. DWQ site is upstream of WFWQC site. Will compare loads to determine if the estimates can be combined.

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = load.TN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = load.TDN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = load.TP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = load.TDP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = load.TOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = load.DOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```


#### Timp SSD


```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, 
              WS_Name == "Timp SSD" & MonitoringLocationIdentifier != "UTAHDWQ_WQX-4995041"),
       aes(x = as.factor(Month), y = load.TN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, 
              WS_Name == "Timp SSD" & MonitoringLocationIdentifier != "UTAHDWQ_WQX-4995041"),
       aes(x = as.factor(Month), y = load.TDN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, 
              WS_Name == "Timp SSD" & MonitoringLocationIdentifier != "UTAHDWQ_WQX-4995041"),
       aes(x = as.factor(Month), y = load.TP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, 
              WS_Name == "Timp SSD" & MonitoringLocationIdentifier != "UTAHDWQ_WQX-4995041"),
       aes(x = as.factor(Month), y = load.TDP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, 
              WS_Name == "Timp SSD" & MonitoringLocationIdentifier != "UTAHDWQ_WQX-4995041"),
       aes(x = as.factor(Month), y = load.TOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, 
              WS_Name == "Timp SSD" & MonitoringLocationIdentifier != "UTAHDWQ_WQX-4995041"),
       aes(x = as.factor(Month), y = load.DOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

REVISIT East side tributary (UTAHDWQ_WQX-4995041) has measurable concentrations but no flow (one near-zero flow, one flow duplicated from 4995038). Scott's recommendation was to average concentrations at 4995041 and 4995038 and apply them to the flow at 4995038, but this assumes that the volume-weighted average is the same as the arithmetic average (i.e., that the volumes at both sites are the same). I'm not sure if this assumption is valid. For now, I will ignore the east side tributary and calculate loads based on the sites that have flow data.


#### Lindon Drain

There are two sites in Lindon Drain. DWQ site is upstream of WFWQC site. Will compare loads to determine if the estimates can be combined.

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = load.TN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = load.TDN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = load.TP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = load.TDP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = load.TOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = load.DOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```


#### Powell Slough Major

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = load.TN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = load.TDN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = load.TP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = load.TDP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = load.TOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = load.DOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

Powell Slough has both North and South outfalls. Need to add together load from North and South to compute total load. WFWQC samples only at the north outfall. 

#### Provo River

There are two site codes in Provo River (one DWQ and one WFWQC), but these are in the same location. Will compare loads to determine if the estimates can be combined.

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = load.TN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = load.TDN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = load.TP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = load.TDP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = load.TOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = load.DOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```


#### Mill Race

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = load.TN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = load.TDN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = load.TP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = load.TDP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = load.TOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none") +
  guides(fill = guide_legend(ncol = 2))

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = load.DOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none") +
  guides(fill = guide_legend(ncol = 2))

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
# ggsave("./Code/Output/MillRace_monthly_allnutrients.jpg", 
#        width = 8, height = 6)

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = MonitoringLocationIdentifier, y = load.TN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Site", y = "TN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  theme(legend.position = "none") +
  guides(fill = guide_legend(ncol = 2))
# ggsave("./Code/Output/MillRace_TN.jpg",
#        width = 7.5, height = 4)

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = MonitoringLocationIdentifier, y = load.TP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Site", y = "TP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  theme(legend.position = "none") +
  guides(fill = guide_legend(ncol = 2))
# ggsave("./Code/Output/MillRace_TP.jpg",
#        width = 7.5, height = 4)

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = MonitoringLocationIdentifier, y = load.TDP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Site", y = "TDP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  theme(legend.position = "none") +
  guides(fill = guide_legend(ncol = 2))
# ggsave("./Code/Output/MillRace_TDP.jpg",
#        width = 7.5, height = 4)

```

4996536 represents the sum total of loading from the watershed. 4996540 and 4996566 should be added together to represent total flow.

#### Spring Creek - Springville

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spring Creek - Springville"),
       aes(x = as.factor(Month), y = load.TN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spring Creek - Springville"),
       aes(x = as.factor(Month), y = load.TDN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spring Creek - Springville"),
       aes(x = as.factor(Month), y = load.TP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spring Creek - Springville"),
       aes(x = as.factor(Month), y = load.TDP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spring Creek - Springville"),
       aes(x = as.factor(Month), y = load.TOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none") +
  guides(fill = guide_legend(ncol = 2))

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spring Creek - Springville"),
       aes(x = as.factor(Month), y = load.DOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none") +
  guides(fill = guide_legend(ncol = 2))

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

4996275 represents Springville WWTP.

#### Hobble Creek

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = load.TN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f",  "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = load.TDN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f",  "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = load.TP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f",  "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = load.TDP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f",  "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = load.TOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f",  "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none") +
  guides(fill = guide_legend(ncol = 2))

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = load.DOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f",  "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none") +
  guides(fill = guide_legend(ncol = 2))

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

4996096 and 4996100 are equivalent sites. 


#### Dry Creek - Spanish Fork

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = load.TN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = load.TDN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = load.TP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = load.TDP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = load.TOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none") +
  guides(fill = guide_legend(ncol = 2))

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = load.DOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none") +
  guides(fill = guide_legend(ncol = 2))

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

4996040 is the primary site in this watershed and represents the sum total of loads. 4996042 and 4996044 represent equivalent sites for the East tributary but do not include the south fork. East tributary sites will be removed and the primary site used for loads.


#### Spanish Fork River

There are two sites in Spanish Fork River. DWQ site is upstream of WFWQC site. Will compare loads to determine if the estimates can be combined.

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = load.TN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = load.TDN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = load.TP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = load.TDP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = load.TOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = load.DOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```


#### 4000 South Drain Spanish Fork

There are two sites in 4000 South Drain Spanish Fork. DWQ site is upstream of WFWQC site. Will compare loads to determine if the estimates can be combined.

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = load.TN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#62197d", "#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = load.TDN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#62197d", "#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = load.TP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#62197d", "#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = load.TDP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#62197d", "#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = load.TOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#62197d", "#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = load.DOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#62197d", "#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```



#### Benjamin Slough

There are two sites in Benjamin Slough. DWQ site is upstream of WFWQC site. Will compare loads to determine if the estimates can be combined.

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = load.TN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = load.TDN.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = load.TP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = load.TDP.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = load.TOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = load.DOC.kgd, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```


#### Currant Creek

Two sites, UTAHDWQ_WQX-4995310 and UTAHDWQ_WQX-4995312, are located at the same coordinates. These sites are pooled in load calculations, as they represent the same location.

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = load.TN.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = load.TDN.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = load.TP.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = load.TDP.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = load.TOC.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = load.DOC.kgd, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC load (kg/d)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

### Monthly and annual load across watersheds

#### Monitored tributaries
```{r}
# Tickville Wash
loading_TickvilleWash <- trib_fac_sites_intersect_downstream %>%
  ungroup() %>%
  filter(WS_Name == "Tickville Wash") %>%
  group_by(WS_Name, Month) %>%
  summarise(Flow.cfs = mean(Flow.cfs, na.rm = TRUE),
            load.TN.kgd = mean(load.TN.kgd, na.rm = TRUE), 
            load.TDN.kgd = mean(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = mean(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = mean(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = mean(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = mean(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ Flow.cfs * 86400 * 31/43559.9,
                                     Month %in% c(4, 6, 9, 11) ~ Flow.cfs * 86400 * 30/43559.9,
                                     Month %in% c(2) ~ Flow.cfs * 86400 * 28/43559.9),
            load.TN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TN.kgd * 28/1000),
            load.TDN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDN.kgd * 28/1000),
            load.TP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TP.kgd * 28/1000),
            load.TDP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDP.kgd * 28/1000),
            load.TOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TOC.kgd * 28/1000),
            load.DOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.DOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.DOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.DOC.kgd * 28/1000)) %>%
  distinct() 

# Dry Creek - Saratoga
loading_DryCreekSaratoga <- trib_fac_sites_intersect_downstream %>%
  ungroup() %>%
  filter(WS_Name == "Dry Creek - Saratoga") %>%
  group_by(WS_Name, Month) %>%
  summarise(Flow.cfs = mean(Flow.cfs, na.rm = TRUE),
            load.TN.kgd = mean(load.TN.kgd, na.rm = TRUE), 
            load.TDN.kgd = mean(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = mean(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = mean(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = mean(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = mean(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ Flow.cfs * 86400 * 31/43559.9,
                                     Month %in% c(4, 6, 9, 11) ~ Flow.cfs * 86400 * 30/43559.9,
                                     Month %in% c(2) ~ Flow.cfs * 86400 * 28/43559.9),
            load.TN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TN.kgd * 28/1000),
            load.TDN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDN.kgd * 28/1000),
            load.TP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TP.kgd * 28/1000),
            load.TDP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDP.kgd * 28/1000),
            load.TOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TOC.kgd * 28/1000),
            load.DOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.DOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.DOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.DOC.kgd * 28/1000)) %>%
  distinct() 

# Lehi Spring Creek
# combine data from DWQ and WFWQC data from two sites
# TP and TDP concentrations are below reporting limit for WFWQC --> use only DWQ samples
loading_LehiSpringCreek <- trib_fac_sites_intersect_downstream %>%
  ungroup() %>%
  filter(WS_Name == "Lehi Spring Creek") %>%
  mutate(load.TP.kgd = case_when(OrganizationIdentifier == "WFWQC_UT" ~ NA_real_,
                                 TRUE ~ load.TP.kgd),
         load.TDP.kgd = case_when(OrganizationIdentifier == "WFWQC_UT" ~ NA_real_,
                                 TRUE ~ load.TDP.kgd)) %>%
  group_by(WS_Name, Month) %>%
  summarise(Flow.cfs = mean(Flow.cfs, na.rm = TRUE),
            load.TN.kgd = mean(load.TN.kgd, na.rm = TRUE), 
            load.TDN.kgd = mean(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = mean(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = mean(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = mean(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = mean(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ Flow.cfs * 86400 * 31/43559.9,
                                     Month %in% c(4, 6, 9, 11) ~ Flow.cfs * 86400 * 30/43559.9,
                                     Month %in% c(2) ~ Flow.cfs * 86400 * 28/43559.9),
            load.TN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TN.kgd * 28/1000),
            load.TDN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDN.kgd * 28/1000),
            load.TP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TP.kgd * 28/1000),
            load.TDP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDP.kgd * 28/1000),
            load.TOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TOC.kgd * 28/1000),
            load.DOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.DOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.DOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.DOC.kgd * 28/1000)) %>%
  distinct() 

# American Fork River
# combine data from DWQ and WFWQC data from two sites
# P and N concentrations are below reporting limit for WFWQC --> use only DWQ samples

loading_AmericanForkRiver <- trib_fac_sites_intersect_downstream %>%
  ungroup() %>%
  filter(WS_Name == "American Fork River") %>%
  filter(OrganizationIdentifier != "WFWQC_UT") %>%
  group_by(WS_Name,  Month) %>%
  summarise(Flow.cfs = mean(Flow.cfs, na.rm = TRUE),
            load.TN.kgd = mean(load.TN.kgd, na.rm = TRUE), 
            load.TDN.kgd = mean(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = mean(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = mean(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = mean(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = mean(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ Flow.cfs * 86400 * 31/43559.9,
                                     Month %in% c(4, 6, 9, 11) ~ Flow.cfs * 86400 * 30/43559.9,
                                     Month %in% c(2) ~ Flow.cfs * 86400 * 28/43559.9),
            load.TN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TN.kgd * 28/1000),
            load.TDN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDN.kgd * 28/1000),
            load.TP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TP.kgd * 28/1000),
            load.TDP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDP.kgd * 28/1000),
            load.TOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TOC.kgd * 28/1000),
            load.DOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.DOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.DOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.DOC.kgd * 28/1000)) %>%
  distinct() 

# Timp SSD
# combine data from DWQ and WFWQC data from two sites
loading_TimpSSD <- trib_fac_sites_intersect_downstream %>%
  ungroup() %>%
  filter(WS_Name == "Timp SSD") %>%
  filter(MonitoringLocationIdentifier != "UTAHDWQ_WQX-4995041") %>%
  group_by(WS_Name, Month) %>%
  summarise(Flow.cfs = mean(Flow.cfs, na.rm = TRUE),
            load.TN.kgd = mean(load.TN.kgd, na.rm = TRUE), 
            load.TDN.kgd = mean(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = mean(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = mean(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = mean(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = mean(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ Flow.cfs * 86400 * 31/43559.9,
                                     Month %in% c(4, 6, 9, 11) ~ Flow.cfs * 86400 * 30/43559.9,
                                     Month %in% c(2) ~ Flow.cfs * 86400 * 28/43559.9),
            load.TN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TN.kgd * 28/1000),
            load.TDN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDN.kgd * 28/1000),
            load.TP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TP.kgd * 28/1000),
            load.TDP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDP.kgd * 28/1000),
            load.TOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TOC.kgd * 28/1000),
            load.DOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.DOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.DOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.DOC.kgd * 28/1000)) %>%
  distinct() 

# Lindon Drain
# WFWQC represents most downstream flow, DWQ data should be added to the DMR data for PacifiCorps Energy to represent total flow and load.
# Lindon Drain DMR data has only flow and TP --> other constituents will be underestimated
# REVISIT: calculate year-month loading for DMR + DWQ. Calculate year-month loading for WFWQC. Combine, then take mean of DMR + DWQ and WFWQC.
loading_LindonDrain_dmr <- dmr_load %>%
  ungroup() %>%
  filter(NPDES.Name == "PacifiCorp Energy") %>%
  group_by(NPDES.Name, Year, Month) %>%
  summarise(load.TP.tonmo = mean(TP.tonmo, na.rm = TRUE), 
            load.TDP.tonmo = mean(PO4.tonmo, na.rm = TRUE),
            load.TKN.tonmo = mean(TKN.tonmo, na.rm = TRUE)) %>%
  distinct() %>%
  full_join(dmr_flow_Lindon) %>%
  ungroup() %>%
  mutate(WS_Name = "Lindon Drain", 
         Year = Year,
         Month = Month,
         Flow.cfs = xxx,
         load.TN.kgd = xxx,
         load.TDN.kgd = xxx,
         load.TP.kgd = xxx,
         load.TDP.kgd = xxx,
         load.TOC.kgd = xxx,
         load.DOC.kgd = xxx,
         Flow.acftmo = xxx,
         load.TN.tonmo = xxx,
         load.TDN.tonmo = xxx,
         load.TP.tonmo = xxx,
         load.TDP.tonmo = xxx,
         load.TOC.tonmo = xxx,
         load.DOC.tonmo = xxx) %>%
  select(-NPDES.Name, -NPES_Name, -Flow.MGD)

loading_LindonDrain_DWQ <- trib_fac_sites_intersect_downstream %>%
  ungroup() %>%
  filter(WS_Name == "Lindon Drain") %>%
  filter(OrganizationIdentifier == "UTAHDWQ_WQX") %>%
  group_by(WS_Name, Year, Month) %>%
  summarise(Flow.cfs = mean(Flow.cfs, na.rm = TRUE),
            load.TN.kgd = mean(load.TN.kgd, na.rm = TRUE), 
            load.TDN.kgd = mean(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = mean(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = mean(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = mean(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = mean(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ Flow.cfs * 86400 * 31/43559.9,
                                     Month %in% c(4, 6, 9, 11) ~ Flow.cfs * 86400 * 30/43559.9,
                                     Month %in% c(2) ~ Flow.cfs * 86400 * 28/43559.9),
            load.TN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TN.kgd * 28/1000),
            load.TDN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDN.kgd * 28/1000),
            load.TP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TP.kgd * 28/1000),
            load.TDP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDP.kgd * 28/1000),
            load.TOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TOC.kgd * 28/1000),
            load.DOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.DOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.DOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.DOC.kgd * 28/1000)) %>%
  distinct() 

loading_LindonDrain_WFWQC <- trib_fac_sites_intersect_downstream %>%
  ungroup() %>%
  filter(WS_Name == "Lindon Drain") %>%
  filter(OrganizationIdentifier == "WFWQC_UT") %>%
  group_by(WS_Name, Month) %>%
  summarise(Flow.cfs = mean(Flow.cfs, na.rm = TRUE),
            load.TN.kgd = mean(load.TN.kgd, na.rm = TRUE),
            load.TDN.kgd = mean(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = mean(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = mean(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = mean(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = mean(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ Flow.cfs * 86400 * 31/43559.9,
                                     Month %in% c(4, 6, 9, 11) ~ Flow.cfs * 86400 * 30/43559.9,
                                     Month %in% c(2) ~ Flow.cfs * 86400 * 28/43559.9),
            load.TN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TN.kgd * 28/1000),
            load.TDN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDN.kgd * 28/1000),
            load.TP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TP.kgd * 28/1000),
            load.TDP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDP.kgd * 28/1000),
            load.TOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TOC.kgd * 28/1000),
            load.DOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.DOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.DOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.DOC.kgd * 28/1000)) %>%
  distinct()


# Powell Slough 
# North Outfall
loading_PowellSloughMajor_north <- trib_fac_sites_intersect_downstream %>%
  ungroup() %>%
  filter(WS_Name == "Powell Slough Major") %>%
  filter(MonitoringLocationIdentifier %in% c("UTAHDWQ_WQX-4995210", "WFWQC_UT-4995210")) %>%
  group_by(WS_Name, Month) %>%
  summarise(Flow.cfs = mean(Flow.cfs, na.rm = TRUE),
            load.TN.kgd = mean(load.TN.kgd, na.rm = TRUE), 
            load.TDN.kgd = mean(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = mean(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = mean(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = mean(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = mean(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ Flow.cfs * 86400 * 31/43559.9,
                                     Month %in% c(4, 6, 9, 11) ~ Flow.cfs * 86400 * 30/43559.9,
                                     Month %in% c(2) ~ Flow.cfs * 86400 * 28/43559.9),
            load.TN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TN.kgd * 28/1000),
            load.TDN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDN.kgd * 28/1000),
            load.TP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TP.kgd * 28/1000),
            load.TDP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDP.kgd * 28/1000),
            load.TOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TOC.kgd * 28/1000),
            load.DOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.DOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.DOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.DOC.kgd * 28/1000)) %>%
  distinct() 

# interpolate missing months

temp <- data.frame(approx(loading_PowellSloughMajor_north$load.TN.kgd, n = 12))
loading_PowellSloughMajor_north$load.TN.kgd <- temp$y
temp <- data.frame(approx(loading_PowellSloughMajor_north$load.TP.kgd, n = 12))
loading_PowellSloughMajor_north$load.TP.kgd <- temp$y
temp <- data.frame(approx(loading_PowellSloughMajor_north$load.TDP.kgd, n = 12))
loading_PowellSloughMajor_north$load.TDP.kgd <- temp$y
temp <- data.frame(approx(loading_PowellSloughMajor_north$load.TN.tonmo, n = 12))
loading_PowellSloughMajor_north$load.TN.tonmo <- temp$y
temp <- data.frame(approx(loading_PowellSloughMajor_north$load.TP.tonmo, n = 12))
loading_PowellSloughMajor_north$load.TP.tonmo <- temp$y
temp <- data.frame(approx(loading_PowellSloughMajor_north$load.TDP.tonmo, n = 12))
loading_PowellSloughMajor_north$load.TDP.tonmo <- temp$y

loading_PowellSloughMajor_north$load.TDN.kgd[is.na(loading_PowellSloughMajor_north$load.TDN.kgd)] <-
  mean(c(loading_PowellSloughMajor_north$load.TDN.kgd[4], loading_PowellSloughMajor_north$load.TDN.kgd[12]))
loading_PowellSloughMajor_north$load.TOC.kgd[is.na(loading_PowellSloughMajor_north$load.TOC.kgd)] <-
  mean(c(loading_PowellSloughMajor_north$load.TOC.kgd[4], loading_PowellSloughMajor_north$load.TOC.kgd[12]))
loading_PowellSloughMajor_north$load.DOC.tonmo[is.na(loading_PowellSloughMajor_north$load.DOC.tonmo)] <-
  mean(c(loading_PowellSloughMajor_north$load.DOC.tonmo[4], loading_PowellSloughMajor_north$load.DOC.tonmo[12]))
loading_PowellSloughMajor_north$load.TDN.tonmo[is.na(loading_PowellSloughMajor_north$load.TDN.tonmo)] <-
  mean(c(loading_PowellSloughMajor_north$load.TDN.tonmo[4], loading_PowellSloughMajor_north$load.TDN.tonmo[12]))
loading_PowellSloughMajor_north$load.TOC.tonmo[is.na(loading_PowellSloughMajor_north$load.TOC.tonmo)] <-
  mean(c(loading_PowellSloughMajor_north$load.TOC.tonmo[4], loading_PowellSloughMajor_north$load.TOC.tonmo[12]))
loading_PowellSloughMajor_north$load.DOC.tonmo[is.na(loading_PowellSloughMajor_north$load.DOC.tonmo)] <-
  mean(c(loading_PowellSloughMajor_north$load.DOC.tonmo[4], loading_PowellSloughMajor_north$load.DOC.tonmo[12]))


# South Outfall
loading_PowellSloughMajor_south <- trib_fac_sites_intersect_downstream %>%
  ungroup() %>%
  filter(WS_Name == "Powell Slough Major") %>%
  filter(MonitoringLocationIdentifier %in% c("UTAHDWQ_WQX-4995230")) %>%
  group_by(WS_Name, Month) %>%
  summarise(Flow.cfs = mean(Flow.cfs, na.rm = TRUE),
            load.TN.kgd = mean(load.TN.kgd, na.rm = TRUE), 
            load.TDN.kgd = mean(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = mean(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = mean(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = mean(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = mean(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ Flow.cfs * 86400 * 31/43559.9,
                                     Month %in% c(4, 6, 9, 11) ~ Flow.cfs * 86400 * 30/43559.9,
                                     Month %in% c(2) ~ Flow.cfs * 86400 * 28/43559.9),
            load.TN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TN.kgd * 28/1000),
            load.TDN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDN.kgd * 28/1000),
            load.TP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TP.kgd * 28/1000),
            load.TDP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDP.kgd * 28/1000),
            load.TOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TOC.kgd * 28/1000),
            load.DOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.DOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.DOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.DOC.kgd * 28/1000)) %>%
  distinct() 

# Add together north and south outfalls
loading_PowellSloughMajor <- loading_PowellSloughMajor_north %>%
  rbind(., loading_PowellSloughMajor_south) %>%
  group_by(WS_Name, Month) %>%
  summarise(Flow.cfs = sum(Flow.cfs, na.rm = TRUE),
            load.TN.kgd = sum(load.TN.kgd, na.rm = TRUE), 
            load.TDN.kgd = sum(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = sum(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = sum(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = sum(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = sum(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = sum(Flow.acftmo, na.rm = TRUE),
            load.TN.tonmo = sum(load.TN.tonmo, na.rm = TRUE),
            load.TDN.tonmo = sum(load.TDN.tonmo, na.rm = TRUE),
            load.TP.tonmo = sum(load.TP.tonmo, na.rm = TRUE),
            load.TDP.tonmo = sum(load.TDP.tonmo, na.rm = TRUE),
            load.TOC.tonmo = sum(load.TOC.tonmo, na.rm = TRUE),
            load.DOC.tonmo = sum(load.DOC.tonmo, na.rm = TRUE))

# loading_PowellSloughMajor_initial <- trib_fac_sites_intersect_downstream %>%
#   ungroup() %>%
#   filter(WS_Name == "Powell Slough Major") %>%
#   group_by(WS_Name, OrganizationIdentifier, MonitoringLocationIdentifier, Month) %>%
#   summarise(Flow.cfs = mean(Flow.cfs, na.rm = TRUE),
#             load.TN.kgd = mean(load.TN.kgd, na.rm = TRUE), 
#             load.TDN.kgd = mean(load.TDN.kgd, na.rm = TRUE),
#             load.TP.kgd = mean(load.TP.kgd, na.rm = TRUE),
#             load.TDP.kgd = mean(load.TDP.kgd, na.rm = TRUE),
#             load.TOC.kgd = mean(load.TOC.kgd, na.rm = TRUE),
#             load.DOC.kgd = mean(load.DOC.kgd, na.rm = TRUE),
#             load.TN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TN.kgd * 31/1000,
#                                      Month %in% c(4, 6, 9, 11) ~ load.TN.kgd * 30/1000,
#                                      Month %in% c(2) ~ load.TN.kgd * 28/1000),
#             load.TDN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDN.kgd * 31/1000,
#                                      Month %in% c(4, 6, 9, 11) ~ load.TDN.kgd * 30/1000,
#                                      Month %in% c(2) ~ load.TDN.kgd * 28/1000),
#             load.TP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TP.kgd * 31/1000,
#                                      Month %in% c(4, 6, 9, 11) ~ load.TP.kgd * 30/1000,
#                                      Month %in% c(2) ~ load.TP.kgd * 28/1000),
#             load.TDP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDP.kgd * 31/1000,
#                                      Month %in% c(4, 6, 9, 11) ~ load.TDP.kgd * 30/1000,
#                                      Month %in% c(2) ~ load.TDP.kgd * 28/1000),
#             load.TOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TOC.kgd * 31/1000,
#                                      Month %in% c(4, 6, 9, 11) ~ load.TOC.kgd * 30/1000,
#                                      Month %in% c(2) ~ load.TOC.kgd * 28/1000),
#             load.DOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.DOC.kgd * 31/1000,
#                                      Month %in% c(4, 6, 9, 11) ~ load.DOC.kgd * 30/1000,
#                                      Month %in% c(2) ~ load.DOC.kgd * 28/1000)) %>%
#   distinct() 

# calculate load from N and S outfalls with WFWQC data from N outfall (DWQ site only at S outfall)
# loading_PowellSloughMajor_WFWQCloads <- loading_PowellSloughMajor_initial %>%
#   filter(MonitoringLocationIdentifier %in% c("UTAHDWQ_WQX-4995230", "WFWQC_UT-4995210")) %>%
#   group_by(WS_Name, Month) %>%
#   summarise(Flow.cfs = sum(Flow.cfs, na.rm = TRUE),
#             load.TN.kgd = sum(load.TN.kgd, na.rm = TRUE), 
#             load.TDN.kgd = sum(load.TDN.kgd, na.rm = TRUE),
#             load.TP.kgd = sum(load.TP.kgd, na.rm = TRUE),
#             load.TDP.kgd = sum(load.TDP.kgd, na.rm = TRUE),
#             load.TOC.kgd = sum(load.TOC.kgd, na.rm = TRUE),
#             load.DOC.kgd = sum(load.DOC.kgd, na.rm = TRUE),
#             load.TN.tonmo = sum(load.TN.tonmo, na.rm = TRUE),
#             load.TDN.tonmo = sum(load.TDN.tonmo, na.rm = TRUE),
#             load.TP.tonmo = sum(load.TP.tonmo, na.rm = TRUE),
#             load.TDP.tonmo = sum(load.TDP.tonmo, na.rm = TRUE),
#             load.TOC.tonmo = sum(load.TOC.tonmo, na.rm = TRUE),
#             load.DOC.tonmo = sum(load.DOC.tonmo, na.rm = TRUE)) %>%
#   mutate(MonitoringLocationIdentifier = "WFWQC_UT-4995210 + UTAHDWQ_WQX-4995230", 
#          OrganizationIdentifier = "WFWQC_UT") %>%
#   select(WS_Name, OrganizationIdentifier, MonitoringLocationIdentifier, Month, 
#          Flow.cfs, load.TN.kgd, load.TDN.kgd, load.TP.kgd, load.TDP.kgd, 
#          load.TOC.kgd, load.DOC.kgd, load.TN.tonmo, load.TDN.tonmo, load.TP.tonmo,
#          load.TDP.tonmo, load.TOC.tonmo, load.DOC.tonmo)

# calculate load from N and S outfalls with DWQ data 
# loading_PowellSloughMajor_UTAHDWQloads <- loading_PowellSloughMajor_initial %>%
#   filter(MonitoringLocationIdentifier %in% c("UTAHDWQ_WQX-4995230", "UTAHDWQ_WQX-4995210")) %>%
#   group_by(WS_Name, Month) %>%
#   summarise(Flow.cfs = sum(Flow.cfs, na.rm = TRUE),
#             load.TN.kgd = sum(load.TN.kgd, na.rm = TRUE), 
#             load.TDN.kgd = sum(load.TDN.kgd, na.rm = TRUE),
#             load.TP.kgd = sum(load.TP.kgd, na.rm = TRUE),
#             load.TDP.kgd = sum(load.TDP.kgd, na.rm = TRUE),
#             load.TOC.kgd = sum(load.TOC.kgd, na.rm = TRUE),
#             load.DOC.kgd = sum(load.DOC.kgd, na.rm = TRUE),
#             load.TN.tonmo = sum(load.TN.tonmo, na.rm = TRUE),
#             load.TDN.tonmo = sum(load.TDN.tonmo, na.rm = TRUE),
#             load.TP.tonmo = sum(load.TP.tonmo, na.rm = TRUE),
#             load.TDP.tonmo = sum(load.TDP.tonmo, na.rm = TRUE),
#             load.TOC.tonmo = sum(load.TOC.tonmo, na.rm = TRUE),
#             load.DOC.tonmo = sum(load.DOC.tonmo, na.rm = TRUE)) %>%
#   mutate(MonitoringLocationIdentifier = "UTAHDWQ_WQX-4995210 + UTAHDWQ_WQX-4995230", 
#          OrganizationIdentifier = "UTAHDWQ_WQX") %>%
#   select(WS_Name, OrganizationIdentifier, MonitoringLocationIdentifier, Month, 
#          Flow.cfs, load.TN.kgd, load.TDN.kgd, load.TP.kgd, load.TDP.kgd, 
#          load.TOC.kgd, load.DOC.kgd, load.TN.tonmo, load.TDN.tonmo, load.TP.tonmo,
#          load.TDP.tonmo, load.TOC.tonmo, load.DOC.tonmo)

#combine loading from different organizations
#loading_PowellSloughMajor <- rbind(loading_PowellSloughMajor_UTAHDWQloads, loading_PowellSloughMajor_WFWQCloads)

# Provo River
# P and N concentrations are below reporting limit for WFWQC --> use only DWQ samples

loading_ProvoRiver <- trib_fac_sites_intersect_downstream %>%
  ungroup() %>%
  filter(WS_Name == "Provo River") %>%
  filter(OrganizationIdentifier != "WFWQC_UT") %>%
  group_by(WS_Name, Month) %>%
  summarise(Flow.cfs = mean(Flow.cfs, na.rm = TRUE),
            load.TN.kgd = mean(load.TN.kgd, na.rm = TRUE), 
            load.TDN.kgd = mean(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = mean(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = mean(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = mean(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = mean(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ Flow.cfs * 86400 * 31/43559.9,
                                     Month %in% c(4, 6, 9, 11) ~ Flow.cfs * 86400 * 30/43559.9,
                                     Month %in% c(2) ~ Flow.cfs * 86400 * 28/43559.9),
            load.TN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TN.kgd * 28/1000),
            load.TDN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDN.kgd * 28/1000),
            load.TP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TP.kgd * 28/1000),
            load.TDP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDP.kgd * 28/1000),
            load.TOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TOC.kgd * 28/1000),
            load.DOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.DOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.DOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.DOC.kgd * 28/1000)) %>%
  distinct() 

# Mill Race
loading_MillRace_initial <- trib_fac_sites_intersect_downstream %>%
  ungroup() %>%
  filter(WS_Name == "Mill Race") %>%
  # leave out WFWQC_UT-4996536. Only 3 samples available.
  filter(MonitoringLocationIdentifier != "WFWQC_UT-4996536") %>%
  group_by(WS_Name, OrganizationIdentifier, MonitoringLocationIdentifier, Month) %>%
  summarise(Flow.cfs = mean(Flow.cfs, na.rm = TRUE),
            load.TN.kgd = mean(load.TN.kgd, na.rm = TRUE), 
            load.TDN.kgd = mean(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = mean(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = mean(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = mean(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = mean(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ Flow.cfs * 86400 * 31/43559.9,
                                     Month %in% c(4, 6, 9, 11) ~ Flow.cfs * 86400 * 30/43559.9,
                                     Month %in% c(2) ~ Flow.cfs * 86400 * 28/43559.9),
            load.TN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TN.kgd * 28/1000),
            load.TDN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDN.kgd * 28/1000),
            load.TP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TP.kgd * 28/1000),
            load.TDP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDP.kgd * 28/1000),
            load.TOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TOC.kgd * 28/1000),
            load.DOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.DOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.DOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.DOC.kgd * 28/1000)) %>%
  distinct() 

# separate 4996540. This site represents a portion of the total load, which will be added to 4996566.

loading_MillRace_4996540 <- loading_MillRace_initial %>%
  filter(MonitoringLocationIdentifier %in% c("UTAHDWQ_WQX-4996540", "WFWQC_UT-4996540")) %>%
  group_by(WS_Name, Month) %>%
  summarise(Flow.cfs = mean(Flow.cfs, na.rm = TRUE),
            load.TN.kgd = mean(load.TN.kgd, na.rm = TRUE), 
            load.TDN.kgd = mean(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = mean(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = mean(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = mean(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = mean(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = mean(Flow.acftmo, na.rm = TRUE),
            load.TN.tonmo = mean(load.TN.tonmo, na.rm = TRUE),
            load.TDN.tonmo = mean(load.TDN.tonmo, na.rm = TRUE),
            load.TP.tonmo = mean(load.TP.tonmo, na.rm = TRUE),
            load.TDP.tonmo = mean(load.TDP.tonmo, na.rm = TRUE),
            load.TOC.tonmo = mean(load.TOC.tonmo, na.rm = TRUE),
            load.DOC.tonmo = mean(load.DOC.tonmo, na.rm = TRUE)) %>%
  mutate(MonitoringLocationIdentifier = "4996540", 
         OrganizationIdentifier = "UTAHDWQ_WQX") %>%
  select(WS_Name, OrganizationIdentifier, MonitoringLocationIdentifier, Month, 
         Flow.cfs, load.TN.kgd, load.TDN.kgd, load.TP.kgd, load.TDP.kgd, 
         load.TOC.kgd, load.DOC.kgd, Flow.acftmo, load.TN.tonmo, load.TDN.tonmo, 
         load.TP.tonmo, load.TDP.tonmo, load.TOC.tonmo, load.DOC.tonmo)

# calculate load from 4996566
loading_MillRace_4996566 <- loading_MillRace_initial %>%
  filter(MonitoringLocationIdentifier %in% c("UTAHDWQ_WQX-4996566"))

# calculate sum of 4996540 and 4996566 These represent the total load.
loading_MillRace <- loading_MillRace_4996540 %>%
  rbind(loading_MillRace_4996566) %>%
  group_by(WS_Name, Month) %>%
  summarise(Flow.cfs = sum(Flow.cfs, na.rm = TRUE),
            load.TN.kgd = sum(load.TN.kgd, na.rm = TRUE), 
            load.TDN.kgd = sum(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = sum(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = sum(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = sum(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = sum(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = sum(Flow.acftmo, na.rm = TRUE),
            load.TN.tonmo = sum(load.TN.tonmo, na.rm = TRUE),
            load.TDN.tonmo = sum(load.TDN.tonmo, na.rm = TRUE),
            load.TP.tonmo = sum(load.TP.tonmo, na.rm = TRUE),
            load.TDP.tonmo = sum(load.TDP.tonmo, na.rm = TRUE),
            load.TOC.tonmo = sum(load.TOC.tonmo, na.rm = TRUE),
            load.DOC.tonmo = sum(load.DOC.tonmo, na.rm = TRUE)) 
 
# Spring Creek - Springville
# combine data from DWQ and WFWQC data from two sites
loading_SpringCreek <- trib_fac_sites_intersect_downstream %>%
  ungroup() %>%
  filter(WS_Name == "Spring Creek - Springville") %>%
  group_by(WS_Name, Month) %>%
  summarise(Flow.cfs = mean(Flow.cfs, na.rm = TRUE),
            load.TN.kgd = mean(load.TN.kgd, na.rm = TRUE), 
            load.TDN.kgd = mean(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = mean(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = mean(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = mean(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = mean(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ Flow.cfs * 86400 * 31/43559.9,
                                     Month %in% c(4, 6, 9, 11) ~ Flow.cfs * 86400 * 30/43559.9,
                                     Month %in% c(2) ~ Flow.cfs * 86400 * 28/43559.9),
            load.TN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TN.kgd * 28/1000),
            load.TDN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDN.kgd * 28/1000),
            load.TP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TP.kgd * 28/1000),
            load.TDP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDP.kgd * 28/1000),
            load.TOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TOC.kgd * 28/1000),
            load.DOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.DOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.DOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.DOC.kgd * 28/1000)) %>%
  distinct() 

# Hobble Creek
# combine data from DWQ and WFWQC data from three sites - all are equivalent
# TP and TDP concentrations are below reporting limit for WFWQC --> use only DWQ samples
 
loading_HobbleCreek <- trib_fac_sites_intersect_downstream %>%
  ungroup() %>%
  filter(WS_Name == "Hobble Creek") %>%
  mutate(load.TP.kgd = case_when(OrganizationIdentifier == "WFWQC_UT" ~ NA_real_,
                                 TRUE ~ load.TP.kgd),
         load.TDP.kgd = case_when(OrganizationIdentifier == "WFWQC_UT" ~ NA_real_,
                                 TRUE ~ load.TDP.kgd)) %>%
  group_by(WS_Name, Month) %>%
  summarise(Flow.cfs = mean(Flow.cfs, na.rm = TRUE),
            load.TN.kgd = mean(load.TN.kgd, na.rm = TRUE), 
            load.TDN.kgd = mean(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = mean(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = mean(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = mean(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = mean(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ Flow.cfs * 86400 * 31/43559.9,
                                     Month %in% c(4, 6, 9, 11) ~ Flow.cfs * 86400 * 30/43559.9,
                                     Month %in% c(2) ~ Flow.cfs * 86400 * 28/43559.9),
            load.TN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TN.kgd * 28/1000),
            load.TDN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDN.kgd * 28/1000),
            load.TP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TP.kgd * 28/1000),
            load.TDP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDP.kgd * 28/1000),
            load.TOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TOC.kgd * 28/1000),
            load.DOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.DOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.DOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.DOC.kgd * 28/1000)) %>%
  distinct() 

# Dry Creek - Spanish Fork
loading_DryCreekSpanishFork <- trib_fac_sites_intersect_downstream %>%
  ungroup() %>%
  filter(WS_Name == "Dry Creek - Spanish Fork") %>%
  filter(MonitoringLocationIdentifier != "UTAHDWQ_WQX-4996042" &
           MonitoringLocationIdentifier != "UTAHDWQ_WQX-4996044") %>%
  group_by(WS_Name, Month) %>%
  summarise(Flow.cfs = mean(Flow.cfs, na.rm = TRUE),
            load.TN.kgd = mean(load.TN.kgd, na.rm = TRUE), 
            load.TDN.kgd = mean(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = mean(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = mean(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = mean(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = mean(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ Flow.cfs * 86400 * 31/43559.9,
                                     Month %in% c(4, 6, 9, 11) ~ Flow.cfs * 86400 * 30/43559.9,
                                     Month %in% c(2) ~ Flow.cfs * 86400 * 28/43559.9),
            load.TN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TN.kgd * 28/1000),
            load.TDN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDN.kgd * 28/1000),
            load.TP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TP.kgd * 28/1000),
            load.TDP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDP.kgd * 28/1000),
            load.TOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TOC.kgd * 28/1000),
            load.DOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.DOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.DOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.DOC.kgd * 28/1000)) %>%
  distinct() 

loading_DryCreekSpanishFork_January <- 
  data.frame(WS_Name = "Dry Creek - Spanish Fork", Month = 1, 
             Flow.cfs = mean(c(loading_DryCreekSpanishFork$Flow.cfs[1], loading_DryCreekSpanishFork$Flow.cfs[11])),
             load.TN.kgd = mean(c(loading_DryCreekSpanishFork$load.TN.kgd[1], loading_DryCreekSpanishFork$load.TN.kgd[11])),
             load.TDN.kgd = mean(c(loading_DryCreekSpanishFork$load.TDN.kgd[1], loading_DryCreekSpanishFork$load.TDN.kgd[11])),
             load.TP.kgd = mean(c(loading_DryCreekSpanishFork$load.TP.kgd[1], loading_DryCreekSpanishFork$load.TP.kgd[11])),
             load.TDP.kgd = mean(c(loading_DryCreekSpanishFork$load.TDP.kgd[2], loading_DryCreekSpanishFork$load.TDP.kgd[11])),
             load.TOC.kgd = mean(c(loading_DryCreekSpanishFork$load.TOC.kgd[1], loading_DryCreekSpanishFork$load.TOC.kgd[11])),
             load.DOC.kgd = mean(c(loading_DryCreekSpanishFork$load.DOC.kgd[1], loading_DryCreekSpanishFork$load.DOC.kgd[11])),
             Flow.acftmo = mean(c(loading_DryCreekSpanishFork$Flow.acftmo[1], loading_DryCreekSpanishFork$Flow.acftmo[11])),
             load.TN.tonmo = mean(c(loading_DryCreekSpanishFork$load.TN.tonmo[1], loading_DryCreekSpanishFork$load.TN.tonmo[11])),
             load.TDN.tonmo = mean(c(loading_DryCreekSpanishFork$load.TDN.tonmo[1], loading_DryCreekSpanishFork$load.TDN.tonmo[11])),
             load.TP.tonmo = mean(c(loading_DryCreekSpanishFork$load.TP.tonmo[1], loading_DryCreekSpanishFork$load.TP.tonmo[11])),
             load.TDP.tonmo = mean(c(loading_DryCreekSpanishFork$load.TDP.tonmo[2], loading_DryCreekSpanishFork$load.TDP.tonmo[11])),
             load.TOC.tonmo = mean(c(loading_DryCreekSpanishFork$load.TOC.tonmo[1], loading_DryCreekSpanishFork$load.TOC.tonmo[11])),
             load.DOC.tonmo = mean(c(loading_DryCreekSpanishFork$load.DOC.tonmo[1], loading_DryCreekSpanishFork$load.DOC.tonmo[11])))

loading_DryCreekSpanishFork <- rbind(loading_DryCreekSpanishFork_January, loading_DryCreekSpanishFork)

loading_DryCreekSpanishFork$load.TDP.kgd[is.na(loading_DryCreekSpanishFork$load.TDP.kgd)] <-
  mean(c(loading_DryCreekSpanishFork$load.TDP.kgd[3], loading_DryCreekSpanishFork$load.TDP.kgd[12]))
loading_DryCreekSpanishFork$load.TDP.tonmo[is.na(loading_DryCreekSpanishFork$load.TDP.tonmo)] <-
  mean(c(loading_DryCreekSpanishFork$load.TDP.tonmo[3], loading_DryCreekSpanishFork$load.TDP.tonmo[12]))

# Spanish Fork
# WFWQC flow is not consistent with DWQ. Per discussion with SP, use only DWQ data

loading_SpanishFork <- trib_fac_sites_intersect_downstream %>%
  ungroup() %>%
  filter(OrganizationIdentifier == "UTAHDWQ_WQX") %>%
  filter(WS_Name == "Spanish Fork River") %>%
  group_by(WS_Name,  Month) %>%
  summarise(Flow.cfs = mean(Flow.cfs, na.rm = TRUE),
            load.TN.kgd = mean(load.TN.kgd, na.rm = TRUE), 
            load.TDN.kgd = mean(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = mean(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = mean(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = mean(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = mean(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ Flow.cfs * 86400 * 31/43559.9,
                                     Month %in% c(4, 6, 9, 11) ~ Flow.cfs * 86400 * 30/43559.9,
                                     Month %in% c(2) ~ Flow.cfs * 86400 * 28/43559.9),
            load.TN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TN.kgd * 28/1000),
            load.TDN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDN.kgd * 28/1000),
            load.TP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TP.kgd * 28/1000),
            load.TDP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDP.kgd * 28/1000),
            load.TOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TOC.kgd * 28/1000),
            load.DOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.DOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.DOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.DOC.kgd * 28/1000)) %>%
  distinct() 

# 4000 South Drain Spanish Fork
# combine data from DWQ and WFWQC data from two sites

loading_4000SouthDrain <- trib_fac_sites_intersect_downstream %>%
  ungroup() %>%
  filter(WS_Name == "4000 South Drain Spanish Fork") %>%
  group_by(WS_Name,  Month) %>%
  summarise(Flow.cfs = mean(Flow.cfs, na.rm = TRUE),
            load.TN.kgd = mean(load.TN.kgd, na.rm = TRUE), 
            load.TDN.kgd = mean(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = mean(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = mean(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = mean(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = mean(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ Flow.cfs * 86400 * 31/43559.9,
                                     Month %in% c(4, 6, 9, 11) ~ Flow.cfs * 86400 * 30/43559.9,
                                     Month %in% c(2) ~ Flow.cfs * 86400 * 28/43559.9),
            load.TN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TN.kgd * 28/1000),
            load.TDN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDN.kgd * 28/1000),
            load.TP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TP.kgd * 28/1000),
            load.TDP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDP.kgd * 28/1000),
            load.TOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TOC.kgd * 28/1000),
            load.DOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.DOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.DOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.DOC.kgd * 28/1000)) %>%
  distinct() 

#interpolate for missing months
temp <- data.frame(approx(loading_4000SouthDrain$load.TN.kgd, n = 12))
loading_4000SouthDrain$load.TN.kgd <- temp$y
temp <- data.frame(approx(loading_4000SouthDrain$load.TDN.kgd, n = 12))
loading_4000SouthDrain$load.TDN.kgd <- temp$y
temp <- data.frame(approx(loading_4000SouthDrain$load.TOC.kgd, n = 12))
loading_4000SouthDrain$load.TOC.kgd <- temp$y
temp <- data.frame(approx(loading_4000SouthDrain$load.DOC.kgd, n = 12))
loading_4000SouthDrain$load.DOC.kgd <- temp$y
temp <- data.frame(approx(loading_4000SouthDrain$load.TN.tonmo, n = 12))
loading_4000SouthDrain$load.TN.tonmo <- temp$y
temp <- data.frame(approx(loading_4000SouthDrain$load.TDN.tonmo, n = 12))
loading_4000SouthDrain$load.TDN.tonmo <- temp$y
temp <- data.frame(approx(loading_4000SouthDrain$load.TOC.tonmo, n = 12))
loading_4000SouthDrain$load.TOC.tonmo <- temp$y
temp <- data.frame(approx(loading_4000SouthDrain$load.DOC.tonmo, n = 12))
loading_4000SouthDrain$load.DOC.tonmo <- temp$y


# Benjamin Slough
# combine data from DWQ and WFWQC data from two sites

loading_BenjaminSlough <- trib_fac_sites_intersect_downstream %>%
  ungroup() %>%
  filter(WS_Name == "Benjamin Slough") %>%
  group_by(WS_Name, Month) %>%
  summarise(Flow.cfs = mean(Flow.cfs, na.rm = TRUE),
            load.TN.kgd = mean(load.TN.kgd, na.rm = TRUE), 
            load.TDN.kgd = mean(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = mean(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = mean(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = mean(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = mean(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ Flow.cfs * 86400 * 31/43559.9,
                                     Month %in% c(4, 6, 9, 11) ~ Flow.cfs * 86400 * 30/43559.9,
                                     Month %in% c(2) ~ Flow.cfs * 86400 * 28/43559.9),
            load.TN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TN.kgd * 28/1000),
            load.TDN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDN.kgd * 28/1000),
            load.TP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TP.kgd * 28/1000),
            load.TDP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDP.kgd * 28/1000),
            load.TOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TOC.kgd * 28/1000),
            load.DOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.DOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.DOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.DOC.kgd * 28/1000)) %>%
  distinct() 

# Currant Creek
# set site codes to the same site
trib_fac_sites_intersect_downstream$MonitoringLocationIdentifier[trib_fac_sites_intersect_downstream$MonitoringLocationIdentifier == "UTAHDWQ_WQX-4995312"] <- 
  "UTAHDWQ_WQX-4995310"

loading_CurrantCreek <- trib_fac_sites_intersect_downstream %>%
  ungroup() %>%
  filter(WS_Name == "Currant Creek") %>%
  group_by(WS_Name,  Month) %>%
  summarise(Flow.cfs = mean(Flow.cfs, na.rm = TRUE),
            load.TN.kgd = mean(load.TN.kgd, na.rm = TRUE), 
            load.TDN.kgd = mean(load.TDN.kgd, na.rm = TRUE),
            load.TP.kgd = mean(load.TP.kgd, na.rm = TRUE),
            load.TDP.kgd = mean(load.TDP.kgd, na.rm = TRUE),
            load.TOC.kgd = mean(load.TOC.kgd, na.rm = TRUE),
            load.DOC.kgd = mean(load.DOC.kgd, na.rm = TRUE),
            Flow.acftmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ Flow.cfs * 86400 * 31/43559.9,
                                     Month %in% c(4, 6, 9, 11) ~ Flow.cfs * 86400 * 30/43559.9,
                                     Month %in% c(2) ~ Flow.cfs * 86400 * 28/43559.9),
            load.TN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TN.kgd * 28/1000),
            load.TDN.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDN.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDN.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDN.kgd * 28/1000),
            load.TP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TP.kgd * 28/1000),
            load.TDP.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TDP.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TDP.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TDP.kgd * 28/1000),
            load.TOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.TOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.TOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.TOC.kgd * 28/1000),
            load.DOC.tonmo = case_when(Month %in% c(1, 3, 5, 7, 8, 10, 12) ~ load.DOC.kgd * 31/1000,
                                     Month %in% c(4, 6, 9, 11) ~ load.DOC.kgd * 30/1000,
                                     Month %in% c(2) ~ load.DOC.kgd * 28/1000)) %>%
  distinct() 

```


#### DMR Data
```{r}

# Timp SSD
loading_TimpSSD_dmr <- dmr_load %>%
  ungroup() %>%
  filter(NPDES.Name == "TIMPANOGOS SPECIAL SERVICE DIS") %>%
  group_by(NPDES.Name, Month) %>%
  summarise(load.TP.tonmo = mean(TP.tonmo, na.rm = TRUE), 
            load.TDP.tonmo = mean(PO4.tonmo, na.rm = TRUE),
            load.TKN.tonmo = mean(TKN.tonmo, na.rm = TRUE)) %>%
  distinct() %>%
  mutate(WS_Name = "Timp SSD")

# Lindon Drain
# Calculate monthly loading from energy facility
loading_LindonDrain_dmr <- dmr_load %>%
  ungroup() %>%
  filter(NPDES.Name == "PacifiCorp Energy") %>%
  group_by(NPDES.Name, Month) %>%
  summarise(load.TP.tonmo = mean(TP.tonmo, na.rm = TRUE), 
            load.TDP.tonmo = mean(PO4.tonmo, na.rm = TRUE),
            load.TKN.tonmo = mean(TKN.tonmo, na.rm = TRUE)) %>%
  distinct() %>%
  mutate(WS_Name = "Lindon Drain")

# Powell Slough
# Calculate monthly loading from Orem WWTP
loading_PowellSloughMajor_dmr <- dmr_load %>%
  ungroup() %>%
  filter(NPDES.Name == "OREM CITY CORP") %>%
  group_by(NPDES.Name, Month) %>%
  summarise(load.TP.tonmo = mean(TP.tonmo, na.rm = TRUE), 
            load.TDP.tonmo = mean(PO4.tonmo, na.rm = TRUE),
            load.TKN.tonmo = mean(TKN.tonmo, na.rm = TRUE)) %>%
  distinct() %>%
  mutate(WS_Name = "Powell Slough Major")

# Mill Race
# Calculate monthly loading from Provo WWTP
loading_MillRace_dmr <- dmr_load %>%
  ungroup() %>%
  filter(NPDES.Name == "PROVO CITY CORP") %>%
  group_by(NPDES.Name, Month) %>%
  summarise(load.TP.tonmo = mean(TP.tonmo, na.rm = TRUE), 
            load.TDP.tonmo = mean(PO4.tonmo, na.rm = TRUE),
            load.TKN.tonmo = mean(TKN.tonmo, na.rm = TRUE)) %>%
  distinct() %>%
  mutate(WS_Name = "Mill Race")

# Hobble Creek
# Calculate loading from Springville WWTP
loading_SpringCreek_dmr <- dmr_load %>%
  ungroup() %>%
  filter(NPDES.Name == "SPRINGVILLE- CITY OF") %>%
  group_by(NPDES.Name, Month) %>%
  summarise(load.TP.tonmo = mean(TP.tonmo, na.rm = TRUE), 
            load.TDP.tonmo = mean(PO4.tonmo, na.rm = TRUE),
            load.TKN.tonmo = mean(TKN.tonmo, na.rm = TRUE)) %>%
  distinct() %>%
  mutate(WS_Name = "Spring Creek - Springville")

# Dry Creek Spanish Fork
# Calculate loading from Spanish Fork WWTP
loading_DryCreekSpanishFork_dmr <- dmr_load %>%
  ungroup() %>%
  filter(NPDES.Name == "SPANISH FORK CITY CORP") %>%
  group_by(NPDES.Name, Month) %>%
  summarise(load.TP.tonmo = mean(TP.tonmo, na.rm = TRUE), 
            load.TDP.tonmo = mean(PO4.tonmo, na.rm = TRUE),
            load.TKN.tonmo = mean(TKN.tonmo, na.rm = TRUE)) %>%
  distinct() %>%
  mutate(WS_Name = "Dry Creek - Spanish Fork")

# Benjamin Slough
# Calculate loading from Payson and Salem. Add loads together.

loading_BenjaminSlough_dmr <- dmr_load %>%
  ungroup() %>%
  filter(NPDES.Name %in% c("SALEM CITY CORP", "PAYSON POWER PROJECT")) %>%
  group_by(NPDES.Name, Month) %>%
  summarise(load.TP.tonmo = mean(TP.tonmo, na.rm = TRUE), 
            load.TDP.tonmo = mean(PO4.tonmo, na.rm = TRUE),
            load.TKN.tonmo = mean(TKN.tonmo, na.rm = TRUE)) %>%
  distinct() %>%
  group_by(Month) %>%
  summarise(load.TP.tonmo = sum(load.TP.tonmo, na.rm = TRUE), 
            load.TDP.tonmo = sum(load.TDP.tonmo, na.rm = TRUE),
            load.TKN.tonmo = sum(load.TKN.tonmo, na.rm = TRUE)) %>%
  mutate(WS_Name = "Benjamin Slough", 
         NPDES.Name = "SALEM CITY CORP & PAYSON POWER PROJECT") %>%
  select(NPDES.Name, Month, load.TP.tonmo, load.TDP.tonmo, load.TKN.tonmo, WS_Name)

loading_AllWatersheds_dmr <- 
  rbind(loading_BenjaminSlough_dmr, loading_DryCreekSpanishFork_dmr, 
        loading_SpringCreek_dmr, loading_MillRace_dmr,
        loading_PowellSloughMajor_dmr, loading_TimpSSD_dmr)

loading_AllWatersheds_dmr$WS_Name <- 
  factor(loading_AllWatersheds_dmr$WS_Name, 
         levels = c("Timp SSD", "Powell Slough Major",  
                    "Mill Race", "Spring Creek - Springville", 
                    "Dry Creek - Spanish Fork", "Benjamin Slough"))

loading_AllWatersheds_dmr_annual <- loading_AllWatersheds_dmr %>%  
  group_by(NPDES.Name, WS_Name) %>%
  summarise(load.TP.tonyr = sum(load.TP.tonmo, na.rm = TRUE), 
            load.TDP.tonyr = sum(load.TDP.tonmo, na.rm = TRUE), 
            load.TKN.tonyr = sum(load.TKN.tonmo, na.rm = TRUE)) 


loading_AllWatersheds_dmr2_annual <- loading_AllWatersheds_dmr_annual %>%
  ungroup() %>%
  mutate(OrganizationIdentifier = "DMR", 
         Flow.cfs = NA, 
         Flow.acftyr = NA,
         load.TN.tonyr = load.TKN.tonyr, 
         load.TDN.tonyr = NA,
         load.TOC.tonyr = NA,
         load.DOC.tonyr = NA) %>%
  select(-NPDES.Name, -load.TKN.tonyr) %>%
  select(WS_Name, Flow.cfs, load.TN.tonyr, load.TDN.tonyr, load.TP.tonyr, 
         Flow.acftyr, load.TDP.tonyr, load.TOC.tonyr, load.DOC.tonyr)

# write.csv(loading_AllWatersheds_dmr,
#           file = "./Data/Processed/loading_AllWatersheds_dmr.csv",
#        row.names = FALSE)
#  
# write.csv(loading_AllWatersheds_dmr2_annual,
#           file = "./Data/Processed/loading_AllWatersheds_dmr_annual.csv",
#        row.names = FALSE)
   
```


```{r}
loading_AllWatersheds <- rbind(
  loading_TickvilleWash, loading_DryCreekSaratoga, 
  loading_LehiSpringCreek, loading_AmericanForkRiver, loading_TimpSSD, 
  loading_LindonDrain, loading_PowellSloughMajor, loading_ProvoRiver, 
  loading_MillRace, loading_SpringCreek, loading_HobbleCreek, loading_DryCreekSpanishFork, 
  loading_SpanishFork, loading_4000SouthDrain, loading_BenjaminSlough, 
  loading_CurrantCreek)

# calculate difference between UTAHDWQ and WFWQC load estimates
# loading_AllWatersheds_differences <- loading_AllWatersheds %>%
#   filter(WS_Name %in% c("Lehi Spring Creek", "American Fork River", "Timp SSD",
#                         "Lindon Drain", "Powell Slough Major", "Provo River", 
#                         "Mill Race", "Spring Creek - Springville", "Hobble Creek", 
#                         "Dry Creek - Spanish Fork", "Spanish Fork River", 
#                         "4000 South Drain Spanish Fork", "Benjamin Slough")) %>%
#   select(-(load.TN.kgd:load.DOC.kgd)) %>%
#   group_by(WS_Name, Month) %>%
#   summarise(load.TN.difference = load.TN.tonmo[OrganizationIdentifier == "UTAHDWQ_WQX"] - 
#               load.TN.tonmo[OrganizationIdentifier == "WFWQC_UT"], 
#             load.TDN.difference = load.TDN.tonmo[OrganizationIdentifier == "UTAHDWQ_WQX"] - 
#               load.TDN.tonmo[OrganizationIdentifier == "WFWQC_UT"], 
#             load.TP.difference = load.TP.tonmo[OrganizationIdentifier == "UTAHDWQ_WQX"] - 
#               load.TP.tonmo[OrganizationIdentifier == "WFWQC_UT"], 
#             load.TDP.difference = load.TDP.tonmo[OrganizationIdentifier == "UTAHDWQ_WQX"] - 
#               load.TN.tonmo[OrganizationIdentifier == "WFWQC_UT"], 
#             load.TOC.difference = load.TOC.tonmo[OrganizationIdentifier == "UTAHDWQ_WQX"] - 
#               load.TOC.tonmo[OrganizationIdentifier == "WFWQC_UT"], 
#             load.DOC.difference = load.DOC.tonmo[OrganizationIdentifier == "UTAHDWQ_WQX"] - 
#               load.DOC.tonmo[OrganizationIdentifier == "WFWQC_UT"])

loading_AllWatersheds_annual <- loading_AllWatersheds %>%
  group_by(WS_Name) %>%
  summarise(Flow.cfs = sum(Flow.cfs), 
            load.TN.tonyr = sum(load.TN.tonmo, na.rm = TRUE), 
            load.TDN.tonyr = sum(load.TDN.tonmo, na.rm = TRUE), 
            load.TP.tonyr = sum(load.TP.tonmo, na.rm = TRUE), 
            Flow.acftyr = sum(Flow.acftmo, na.rm = TRUE),
            load.TDP.tonyr = sum(load.TDP.tonmo, na.rm = TRUE), 
            load.TOC.tonyr = sum(load.TOC.tonmo, na.rm = TRUE), 
            load.DOC.tonyr = sum(load.DOC.tonmo, na.rm = TRUE))

loading_Total_annual <- loading_AllWatersheds_annual %>%
  ungroup() %>%
  summarise(Flow.acftyr = sum(Flow.acftyr, na.rm = TRUE), 
            load.TN.tonyr = sum(load.TN.tonyr, na.rm = TRUE), 
            load.TDN.tonyr = sum(load.TDN.tonyr, na.rm = TRUE), 
            load.TP.tonyr = sum(load.TP.tonyr, na.rm = TRUE), 
            load.TDP.tonyr = sum(load.TDP.tonyr, na.rm = TRUE), 
            load.TOC.tonyr = sum(load.TOC.tonyr, na.rm = TRUE), 
            load.DOC.tonyr = sum(load.DOC.tonyr, na.rm = TRUE))
  
loading_AllWatersheds_annual_combined <- 
  rbind(loading_AllWatersheds_annual, loading_AllWatersheds_dmr2_annual)


# write.csv(loading_AllWatersheds, file = "./Data/Processed/loading_AllWatersheds.csv",
#        row.names = FALSE)
# write.csv(loading_AllWatersheds_annual, file = "./Data/Processed/loading_AllWatersheds_annual.csv",
#        row.names = FALSE)

```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
ggplot(loading_AllWatersheds, aes(x = Month, y = load.TN.tonmo, color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3) +
  scale_y_log10() +
  scale_x_continuous(n.breaks = 12) +
  labs(y = "TN load (ton/mo)", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

ggplot(loading_AllWatersheds, aes(x = Month, y = load.TDN.tonmo, color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3) +
  scale_y_log10() +
  scale_x_continuous(n.breaks = 12) +
  labs(y = "TDN load (ton/mo)", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

ggplot(loading_AllWatersheds, aes(x = Month, y = load.TP.tonmo, color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3) +
  scale_y_log10() +
  scale_x_continuous(n.breaks = 12) +
  labs(y = "TP load (ton/mo)", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

ggplot(loading_AllWatersheds, aes(x = Month, y = load.TDP.tonmo, color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3) +
  scale_y_log10() +
  scale_x_continuous(n.breaks = 12) +
  labs(y = "TDP load (ton/mo)", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

ggplot(loading_AllWatersheds, aes(x = Month, y = load.TOC.tonmo, color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3) +
  scale_y_log10() +
  scale_x_continuous(n.breaks = 12) +
  labs(y = "TOC load (ton/mo)", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

ggplot(loading_AllWatersheds, aes(x = Month, y = load.DOC.tonmo, color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3) +
  scale_y_log10() +
  scale_x_continuous(n.breaks = 12) +
  labs(y = "DOC load (ton/mo)", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

```


```{r}
ggplot(loading_AllWatersheds_differences, aes(x = Month, y = load.TN.difference)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3, scales = "free_y") +
  scale_x_continuous(n.breaks = 12) +
  labs(y = "TN load difference (UTAHDWQ-WFWQC, ton/mo)", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

ggplot(loading_AllWatersheds_differences, aes(x = Month, y = load.TDN.difference)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3, scales = "free_y") +
  scale_x_continuous(n.breaks = 12) +
  labs(y = "TDN load difference (UTAHDWQ-WFWQC, ton/mo)", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

ggplot(loading_AllWatersheds_differences, aes(x = Month, y = load.TP.difference)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3, scales = "free_y") +
  scale_x_continuous(n.breaks = 12) +
  labs(y = "TP load difference (UTAHDWQ-WFWQC, ton/mo)", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

ggplot(loading_AllWatersheds_differences, aes(x = Month, y = load.TDP.difference)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3, scales = "free_y") +
  scale_x_continuous(n.breaks = 12) +
  labs(y = "TDP load difference (UTAHDWQ-WFWQC, ton/mo)", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

ggplot(loading_AllWatersheds_differences, aes(x = Month, y = load.TOC.difference)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3, scales = "free_y") +
  scale_x_continuous(n.breaks = 12) +
  labs(y = "TOC load difference (UTAHDWQ-WFWQC, ton/mo)", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

ggplot(loading_AllWatersheds_differences, aes(x = Month, y = load.DOC.difference)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3, scales = "free_y") +
  scale_x_continuous(n.breaks = 12) +
  labs(y = "DOC load difference (UTAHDWQ-WFWQC, ton/mo)", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")


```


```{r}
ggplot(loading_AllWatersheds, 
       aes(x = WS_Name, y = load.TN.tonmo, fill = as.factor(Month))) +
  geom_bar(stat = "identity") +
    scale_fill_viridis_d(option = "magma") +
  facet_wrap(vars(OrganizationIdentifier)) +
  labs(x = "", y = "TN loading (tons/year)", fill = "Month") +
  theme(legend.position = "top", axis.text.x = element_text(angle = 45, hjust = 1))

ggplot(loading_AllWatersheds_dmr, 
       aes(x = WS_Name, y = load.TKN.tonmo, fill = as.factor(Month))) +
  geom_bar(stat = "identity") +
    scale_fill_viridis_d(option = "magma") +
  labs(x = "", y = "TN loading (tons/year)", fill = "Month") +
  theme(legend.position = "top", axis.text.x = element_text(angle = 45, hjust = 1))

ggplot(subset(loading_AllWatersheds, OrganizationIdentifier == "UTAHDWQ_WQX"),
       aes(x = WS_Name, y = load.TDN.tonmo, fill = as.factor(Month))) +
  geom_bar(stat = "identity") +
    scale_fill_viridis_d(option = "magma") +
  labs(x = "", y = "TDN loading (tons/year)", fill = "Month") +
  theme(legend.position = "top", axis.text.x = element_text(angle = 45, hjust = 1))

ggplot(loading_AllWatersheds, 
       aes(x = WS_Name, y = load.TP.tonmo, fill = as.factor(Month))) +
  geom_bar(stat = "identity") +
    scale_fill_viridis_d(option = "magma") +
  facet_wrap(vars(OrganizationIdentifier)) +
  labs(x = "", y = "TP loading (tons/year)", fill = "Month") +
  theme(legend.position = "top", axis.text.x = element_text(angle = 45, hjust = 1))

ggplot(loading_AllWatersheds_dmr, 
       aes(x = WS_Name, y = load.TP.tonmo, fill = as.factor(Month))) +
  geom_bar(stat = "identity") +
    scale_fill_viridis_d(option = "magma") +
  labs(x = "", y = "TN loading (tons/year)", fill = "Month") +
  theme(legend.position = "top", axis.text.x = element_text(angle = 45, hjust = 1))

ggplot(loading_AllWatersheds, 
       aes(x = WS_Name, y = load.TDP.tonmo, fill = as.factor(Month))) +
  geom_bar(stat = "identity") +
    scale_fill_viridis_d(option = "magma") +
  facet_wrap(vars(OrganizationIdentifier)) +
  labs(x = "", y = "TDP loading (tons/year)", fill = "Month") +
  theme(legend.position = "top", axis.text.x = element_text(angle = 45, hjust = 1))

ggplot(loading_AllWatersheds_dmr, 
       aes(x = WS_Name, y = load.TDP.tonmo, fill = as.factor(Month))) +
  geom_bar(stat = "identity") +
    scale_fill_viridis_d(option = "magma") +
  labs(x = "", y = "TN loading (tons/year)", fill = "Month") +
  theme(legend.position = "top", axis.text.x = element_text(angle = 45, hjust = 1))

ggplot(subset(loading_AllWatersheds, OrganizationIdentifier == "UTAHDWQ_WQX"),
       aes(x = WS_Name, y = load.TOC.tonmo, fill = as.factor(Month))) +
  geom_bar(stat = "identity") +
    scale_fill_viridis_d(option = "magma") +
  labs(x = "", y = "TOC loading (tons/year)", fill = "Month") +
  theme(legend.position = "top", axis.text.x = element_text(angle = 45, hjust = 1))

ggplot(subset(loading_AllWatersheds, OrganizationIdentifier == "UTAHDWQ_WQX"),
       aes(x = WS_Name, y = load.DOC.tonmo, fill = as.factor(Month))) +
  geom_bar(stat = "identity") +
    scale_fill_viridis_d(option = "magma") +
  labs(x = "", y = "DOC loading (tons/year)", fill = "Month") +
  theme(legend.position = "top", axis.text.x = element_text(angle = 45, hjust = 1))

ggplot(loading_AllWatersheds_annual_combined, 
       aes(x = WS_Name, y = load.TP.tonyr, fill = OrganizationIdentifier)) +
  geom_bar(stat = "identity", position = position_dodge(preserve = "single")) +
  scale_fill_viridis_d(option = "magma", begin = 0.2, end = 0.8) +
  labs(x = "", y = "TP loading (tons/year)", fill = "Source") +
  theme(legend.position = "top", axis.text.x = element_text(angle = 45, hjust = 1))

ggplot(loading_AllWatersheds_annual_combined, 
       aes(x = WS_Name, y = load.TN.tonyr, fill = OrganizationIdentifier)) +
  geom_bar(stat = "identity", position = position_dodge(preserve = "single")) +
  scale_fill_viridis_d(option = "magma", begin = 0.2, end = 0.8) +
  labs(x = "", y = "TN loading (tons/year)", fill = "Source") +
  theme(legend.position = "top", axis.text.x = element_text(angle = 45, hjust = 1))
  
```

### C-Q

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# TN
ggplot(trib_fac_sites_intersect_downstream, 
       aes(x = Flow.cfs, y = TN, color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 4) +
  scale_x_log10() +
  scale_y_log10() +
  labs(x = "Flow (cfs)", y = "TN (mg/L)", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")
ggsave("./Code/Output/CQ_TN.jpg", width = 8, height = 6, units = "in")

# watersheds w/o WWTP, compare entities
ggplot(subset(trib_fac_sites_intersect_downstream,
              WS_Name %in% c("Lehi Spring Creek", "American Fork River", 
                             "Lindon Drain", "Provo River", "Hobble Creek", 
                             "Spanish Fork River", "4000 South Drain Spanish Fork")),
       aes(x = Flow.cfs, y = TN, 
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 4) +
  scale_x_log10() +
  scale_y_log10() +
  labs(x = "Flow (cfs)", y = "TN (mg/L)", shape = "Site Type", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")
ggsave("./Code/Output/CQ_TN_noWWTP.jpg", width = 7, height = 4, units = "in")

# watersheds w/ WWTP, compare entities
ggplot(subset(trib_fac_sites_intersect_downstream,
              WS_Name %in% c("Timp SSD", "Powell Slough Major", "Mill Race",
                             "Spring Creek - Springville", 
                             "Dry Creek - Spanish Fork", "Benjamin Slough")),
       aes(x = Flow.cfs, y = TN, 
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3) +
  scale_x_log10() +
  scale_y_log10() +
  labs(x = "Flow (cfs)", y = "TN (mg/L)", shape = "Site Type", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")
ggsave("./Code/Output/CQ_TN_WWTP.jpg", width = 5.25, height = 4, units = "in")

# TDN
ggplot(trib_fac_sites_intersect_downstream, 
       aes(x = Flow.cfs, y = TDN, color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 4) +
  scale_x_log10() +
  scale_y_log10() +
  labs(x = "Flow (cfs)", y = "TDN (mg/L)", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")
ggsave("./Code/Output/CQ_TDN.jpg", width = 8, height = 6, units = "in")

# TP
ggplot(trib_fac_sites_intersect_downstream, 
       aes(x = Flow.cfs, y = TP, color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 4) +
  scale_x_log10() +
  scale_y_log10() +
  labs(x = "Flow (cfs)", y = "TP (mg/L)", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")
ggsave("./Code/Output/CQ_TP.jpg", width = 8, height = 6, units = "in")

# watersheds w/o WWTP, compare entities
ggplot(subset(trib_fac_sites_intersect_downstream,
              WS_Name %in% c("Lehi Spring Creek", "American Fork River", 
                             "Lindon Drain", "Provo River", "Hobble Creek", 
                             "Spanish Fork River", "4000 South Drain Spanish Fork")),
       aes(x = Flow.cfs, y = TP, 
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 4) +
  scale_x_log10() +
  scale_y_log10() +
  labs(x = "Flow (cfs)", y = "TP (mg/L)", shape = "Site Type", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")
ggsave("./Code/Output/CQ_TP_noWWTP.jpg", width = 7, height = 4, units = "in")

# watersheds w/ WWTP, compare entities
ggplot(subset(trib_fac_sites_intersect_downstream,
              WS_Name %in% c("Timp SSD", "Powell Slough Major", "Mill Race",
                             "Spring Creek - Springville", 
                             "Dry Creek - Spanish Fork", "Benjamin Slough")),
       aes(x = Flow.cfs, y = TP, 
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3) +
  scale_x_log10() +
  scale_y_log10() +
  labs(x = "Flow (cfs)", y = "TP (mg/L)", shape = "Site Type", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")
ggsave("./Code/Output/CQ_TP_WWTP.jpg", width = 5.25, height = 4, units = "in")

# TDP
ggplot(trib_fac_sites_intersect_downstream, 
       aes(x = Flow.cfs, y = TDP, color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 4) +
  scale_x_log10() +
  scale_y_log10() +
  labs(x = "Flow (cfs)", y = "TDP (mg/L)", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")
ggsave("./Code/Output/CQ_TDP.jpg", width = 8, height = 6, units = "in")

# TOC
ggplot(trib_fac_sites_intersect_downstream, 
       aes(x = Flow.cfs, y = TOC, color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 4) +
  scale_x_log10() +
  scale_y_log10() +
  labs(x = "Flow (cfs)", y = "TOC (mg/L)",  color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")
ggsave("./Code/Output/CQ_TOC.jpg", width = 8, height = 6, units = "in")

# DOC
ggplot(trib_fac_sites_intersect_downstream, 
       aes(x = Flow.cfs, y = DOC, color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 4) +
  scale_x_log10() +
  scale_y_log10() +
  labs(x = "Flow (cfs)", y = "DOC (mg/L)", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")
ggsave("./Code/Output/CQ_DOC.jpg", width = 8, height = 6, units = "in")

```

### Precipitation and evaporation


```{r, echo = FALSE, message = FALSE, warning = FALSE, width = 5, height = 4}


ggplot(p_et_summary, aes(x = as.factor(Month), y = precip.acftmo)) +
  geom_boxplot() +
  labs(y = "Monthly precipitation (ac*ft/mo)", x = "Month") 
#ggsave("./Code/Output/precipitation_monthly.jpg", width = 4, height = 3)

ggplot(p_et_summary, aes(x = as.factor(Month), y = et.acftmo)) +
  geom_boxplot() +
  labs(y = "Monthly evaporation (ac*ft/mo)", x = "Month") 
#ggsave("./Code/Output/evaporation_monthly.jpg", width = 4, height = 3)

```

## Appendix

### Nutrient concentrations and flow across watersheds

#### Watersheds w/ UDWQ only, no WWTP

TN

```{r}

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Tickville Wash"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 200, lty = 2, color = "#f27162") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TN ("*mu*"g/L)"), fill = "Site", title = "Tickville Wash") +
  scale_fill_manual(values = c("#f27162")) +
  theme(legend.position = "top")
ggsave("./Code/Output/TNconc_Tickville.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 200, lty = 2, color = "#f27162") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TN ("*mu*"g/L)"), fill = "Site", title = "Dry Creek - Saratoga") +
  scale_fill_manual(values = c("#f27162")) +
  theme(legend.position = "top")
ggsave("./Code/Output/TNconc_DrySaratoga.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 200, lty = 2, color = "#f27162") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TN ("*mu*"g/L)"), fill = "Site", title = "Currant Creek") +
  scale_fill_manual(values = c("#f27162", "#db4a69")) +
  theme(legend.position = "top")
ggsave("./Code/Output/TNconc_Currant.jpg", height = 4, width = 5, units = "in")

```


TP

```{r}
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Tickville Wash"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 3, lty = 2, color = "#f27162") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TP ("*mu*"g/L)"), fill = "Site", title = "Tickville Wash") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
ggsave("./Code/Output/TPconc_Tickville.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 3, lty = 2, color = "#f27162") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TP ("*mu*"g/L)"), fill = "Site", title = "Dry Creek - Saratoga") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
ggsave("./Code/Output/TPconc_DrySaratoga.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 3, lty = 2, color = "#f27162") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TP ("*mu*"g/L)"), fill = "Site", title = "Currant Creek") +
  scale_fill_manual(values = c("#f27162", "#db4a69")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
ggsave("./Code/Output/TPconc_Currant.jpg", height = 4, width = 5, units = "in")


```

Flow

```{r}
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Tickville Wash"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  scale_y_log10() +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site", title = "Tickville Wash") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
ggsave("./Code/Output/Flow_Tickville.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  scale_y_log10() +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site", title = "Dry Creek - Saratoga") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
ggsave("./Code/Output/Flow_DrySaratoga.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  scale_y_log10() +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site", title = "Currant Creek") +
  scale_fill_manual(values = c("#f27162", "#db4a69")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
ggsave("./Code/Output/Flow_Currant.jpg", height = 4, width = 5, units = "in")

```


#### Watersheds w/ UDWQ and WFWQC, no WWTP

TN

```{r}

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 200, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 700, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TN ("*mu*"g/L)"), fill = "Site", title = "Lehi Spring Creek") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  theme(legend.position = "top")
ggsave("./Code/Output/TNconc_Lehi.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 200, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 700, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TN ("*mu*"g/L)"), fill = "Site", title = "American Fork River") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  theme(legend.position = "top")
ggsave("./Code/Output/TNconc_American.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 200, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 700, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TN ("*mu*"g/L)"), fill = "Site", title = "Lindon Drain") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  theme(legend.position = "top")
ggsave("./Code/Output/TNconc_Lindon.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 200, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 700, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TN ("*mu*"g/L)"), fill = "Site", title = "Provo River") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  theme(legend.position = "top")
ggsave("./Code/Output/TNconc_Provo.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 200, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 700, lty = 2, color = "#62197d") +
  scale_y_log10() +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TN ("*mu*"g/L)"), fill = "Site", title = "Hobble Creek") +
  scale_fill_manual(values = c("#fc9d6f",  "#8a2880", "#3b1165")) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(nrow = 2))
ggsave("./Code/Output/TNconc_Hobble.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 200, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 700, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  ylim(0, 2000) +
  labs(x = "Month", y = expression("TN ("*mu*"g/L)"), fill = "Site", title = "Spanish Fork River") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  theme(legend.position = "top")
ggsave("./Code/Output/TNconc_Spanish.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 200, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 700, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TN ("*mu*"g/L)"), fill = "Site", title = "4000 South Drain Spanish Fork") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  theme(legend.position = "top")
ggsave("./Code/Output/TNconc_4000.jpg", height = 4, width = 5, units = "in")

```


TP

```{r}
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 3, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 21, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TP ("*mu*"g/L)"), fill = "Site", title = "Lehi Spring Creek") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
ggsave("./Code/Output/TPconc_Lehi.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 3, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 21, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TP ("*mu*"g/L)"), fill = "Site", title = "American Fork River") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
ggsave("./Code/Output/TPconc_American.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 3, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 21, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TP ("*mu*"g/L)"), fill = "Site", title = "Lindon Drain") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
ggsave("./Code/Output/TPconc_Lindon.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 3, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 21, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TP ("*mu*"g/L)"), fill = "Site", title = "Provo River") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
ggsave("./Code/Output/TPconc_Provo.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 3, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 21, lty = 2, color = "#62197d") +
  scale_y_log10() +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TP ("*mu*"g/L)"), fill = "Site", title = "Hobble Creek") +
  scale_fill_manual(values = c("#fc9d6f",  "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")+
  guides(fill = guide_legend(nrow = 2))
ggsave("./Code/Output/TPconc_Hobble.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 3, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 21, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TP ("*mu*"g/L)"), fill = "Site", title = "Spanish Fork River") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
ggsave("./Code/Output/TPconc_Spanish.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 3, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 21, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TP ("*mu*"g/L)"), fill = "Site", title = "4000 South Drain Spanish Fork") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  theme(legend.position = "top")
ggsave("./Code/Output/TPconc_4000.jpg", height = 4, width = 5, units = "in")

```

Flow

```{r}
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  scale_y_log10() +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site", title = "Lehi Spring Creek") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
ggsave("./Code/Output/Flow_Lehi.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  scale_y_log10() +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site", title = "American Fork River") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
ggsave("./Code/Output/Flow_American.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  scale_y_log10() +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site", title = "Lindon Drain") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
ggsave("./Code/Output/Flow_Lindon.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  scale_y_log10() +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site", title = "Provo River") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
ggsave("./Code/Output/Flow_Provo.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  scale_y_log10() +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site", title = "Hobble Creek") +
  scale_fill_manual(values = c("#fc9d6f",  "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top") +
  guides(fill = guide_legend(nrow = 2))
ggsave("./Code/Output/Flow_Hobble.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  scale_y_log10() +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site", title = "Spanish Fork River") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
ggsave("./Code/Output/Flow_Spanish.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  scale_y_log10() +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site", title = "4000 South Drain Spanish Fork") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  theme(legend.position = "top")
ggsave("./Code/Output/Flow_4000.jpg", height = 4, width = 5, units = "in")

```


#### Watersheds w/ UDWQ and WFWQC, plus WWTP

TN

```{r}

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Timp SSD"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 200, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 700, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TN ("*mu*"g/L)"), fill = "Site", title = "Timp SSD") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(nrow = 2))
ggsave("./Code/Output/TNconc_TimpSSD.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 200, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 700, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TN ("*mu*"g/L)"), fill = "Site", title = "Powell Slough Major") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(nrow = 2))
ggsave("./Code/Output/TNconc_Powell.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 200, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 700, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TN ("*mu*"g/L)"), fill = "Site", title = "Mill Race") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(nrow = 2))
ggsave("./Code/Output/TNconc_MillRace.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spring Creek - Springville"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 200, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 700, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TN ("*mu*"g/L)"), fill = "Site", title = "Spring Creek - Springville") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  theme(legend.position = "top")
ggsave("./Code/Output/TNconc_Spring.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 200, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 700, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TN ("*mu*"g/L)"), fill = "Site", title = "Dry Creek - Spanish Fork") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(nrow = 2))
ggsave("./Code/Output/TNconc_DrySpanish.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 200, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 700, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TN ("*mu*"g/L)"), fill = "Site", title = "Benjamin Slough") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  theme(legend.position = "top")
ggsave("./Code/Output/TNconc_Benjamin.jpg", height = 4, width = 5, units = "in")

```


TP

```{r}

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Timp SSD"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 3, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 21, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TP ("*mu*"g/L)"), fill = "Site", title = "Timp SSD") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(nrow = 2))
ggsave("./Code/Output/TPconc_TimpSSD.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 3, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 21, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TP ("*mu*"g/L)"), fill = "Site", title = "Powell Slough Major") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(nrow = 2))
ggsave("./Code/Output/TPconc_Powell.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 3, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 21, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TP ("*mu*"g/L)"), fill = "Site", title = "Mill Race") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(nrow = 2))
ggsave("./Code/Output/TPconc_MillRace.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spring Creek - Springville"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 3, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 21, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TP ("*mu*"g/L)"), fill = "Site", title = "Spring Creek - Springville") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  theme(legend.position = "top")
ggsave("./Code/Output/TPconc_Spring.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 3, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 21, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TP ("*mu*"g/L)"), fill = "Site", title = "Dry Creek - Spanish Fork") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(nrow = 2))
ggsave("./Code/Output/TPconc_DrySpanish.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  geom_hline(yintercept = 3, lty = 2, color = "#f27162") +
  geom_hline(yintercept = 21, lty = 2, color = "#62197d") +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = expression("TP ("*mu*"g/L)"), fill = "Site", title = "Benjamin Slough") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  theme(legend.position = "top")
ggsave("./Code/Output/TPconc_Benjamin.jpg", height = 4, width = 5, units = "in")

```

Flow

```{r}
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  scale_y_log10() +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site", title = "Lehi Spring Creek") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
ggsave("./Code/Output/Flow_Lehi.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Timp SSD"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  scale_y_log10(limits = c(10, 100)) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site", title = "Timp SSD") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(nrow = 2))
ggsave("./Code/Output/Flow_TimpSSD.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  scale_y_log10() +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site", title = "Powell Slough Major") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(nrow = 2))
ggsave("./Code/Output/Flow_Powell.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  scale_y_log10() +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site", title = "Mill Race") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(nrow = 2))
ggsave("./Code/Output/Flow_MillRace.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spring Creek - Springville"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  scale_y_log10() +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site", title = "Spring Creek - Springville") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  theme(legend.position = "top")
ggsave("./Code/Output/Flow_Spring.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  scale_y_log10() +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site", title = "Dry Creek - Spanish Fork") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  theme(legend.position = "top") +
  guides(fill = guide_legend(nrow = 2))
ggsave("./Code/Output/Flow_DrySpanish.jpg", height = 4, width = 5, units = "in")

ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  scale_y_log10() +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  ylim(0, 2) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site", title = "Benjamin Slough") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  theme(legend.position = "top")
ggsave("./Code/Output/Flow_Benjamin.jpg", height = 4, width = 5, units = "in")

```

#### Tickville Wash

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Tickville Wash"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Tickville Wash"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Tickville Wash"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Tickville Wash"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Tickville Wash"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Tickville Wash"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

#### Dry Creek - Saratoga

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

#### Lehi Spring Creek

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

#### American Fork River

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

#### Timp SSD

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Timp SSD"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Timp SSD"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Timp SSD"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Timp SSD"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Timp SSD"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Timp SSD"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

#### Lindon Drain

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

#### Powell Slough Major

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

#### Provo River

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

#### Mill Race

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none") +
  guides(fill = guide_legend(ncol = 2))

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none") +
  guides(fill = guide_legend(ncol = 2))

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

#### Spring Creek - Springville
```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spring Creek - Springville"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spring Creek - Springville"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spring Creek - Springville"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spring Creek - Springville"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spring Creek - Springville"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spring Creek - Springville"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))

```

#### Hobble Creek

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f",  "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f",  "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f",  "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f",  "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f",  "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none") +
  guides(fill = guide_legend(ncol = 2))

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f",  "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none") +
  guides(fill = guide_legend(ncol = 2))

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

#### Dry Creek - Spanish Fork

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank()) +
  guides(fill = guide_legend(ncol = 2))

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none") +
  guides(fill = guide_legend(ncol = 2))

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none") +
  guides(fill = guide_legend(ncol = 2))

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

#### Spanish Fork River

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

#### 4000 South Drain Spanish Fork

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#62197d", "#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#62197d", "#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#62197d", "#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

#### Benjamin Slough

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

#### Currant Creek

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

## Spare code

```{r, include = FALSE}
DmrFac <- read.csv("./Data/Processed/DmrFacilityInfo.csv")

Dmr_Sp <- st_as_sf(DmrFac,coords = c("dec_long", "dec_lat"),crs=4236)


```

