---
title: "UtahLake_TributaryData"
author: "Kateri Salk"
date: "1/5/2021"
output:
  html_document: default
  pdf_document: default
editor_options:
  chunk_output_type: console
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(lubridate)
library(viridis)
library(wqTools)
library(sf)
library(tmap)
library(cowplot)
library(openxlsx)

theme_set(theme_classic())
options(scipen = 4)
```

## Details


## Load data

Data were loaded from spreadsheets obtained by Utah DWQ: 

```{r}
# tributary data
trib <- read.csv("./Data/Processed/ul_Tribdata_wqp_processed_2020-12-17.csv")
# facility data
fac <- read.csv("./Data/Processed/ul_Facilitydata_wqp_processed.csv")
# watershed spatial data
wshds <- read_sf("./Data/GIS/ulSubWshdsWGS84.shp")
# sampling activity logs
activitylog <- read.csv("./Data/Processed/UL_Trib_SampleActivities_exported 12-17-20.csv")
# groundwater data
gw <- read.csv("./Data/Processed/ul_wqp_gwdata_processed.csv")
# precipitation and evaporation data
p_et <- read.xlsx("./Data/Processed/ULEFDCFlowBoundaries_WY2006-2018.xlsx", 
                  sheet = "Precip-ET", startRow = 2)
```

## Data processing

### Watersheds

Watersheds were divided into monitored and unmonitored and arranged in clockwise order.

```{r}
wshds_monitored <- wshds %>%
  filter(Monitored_ == "YES")

wshds_monitored$WS_Name <- 
  factor(wshds_monitored$WS_Name, 
         levels = c("Lake Mountain - Israel Canyon", "Dry Creek - Saratoga", 
                    "Lehi Spring Creek", "American Fork River", "Timp SSD", 
                    "Lindon Drain", "Powell Slough Major", "Provo River", 
                    "Mill Race", "Hobble Creek", "Dry Creek - Spanish Fork",
                    "Spanish Fork River", "4000 South Drain Spanish Fork",
                    "Benjamin Slough", "Currant Creek"))
levels(wshds_monitored$WS_Name)

```


### Tributary data

Tributary dataset was filtered for: 

1. Variables pertaining to C, N, P, or flow (discharge)
2. Years 2015-2020

Flow data were converted to cubic feet/sec (cfs) when units originally appeared as gallon/min, cubic meters/sec, and million gallons/day.

```{r, include = FALSE}
trib$ActivityStartDate <- as.Date(trib$ActivityStartDate)
# unique(trib$CharacteristicName)
trib$ResultMeasureValue <- as.numeric(as.character(trib$ResultMeasureValue))

trib_wq <- trib %>%
  filter(CharacteristicName %in% 
           c("Ammonia-nitrogen as N", "Carbon", "Nitrate as N", "Organic carbon",
             "Ammonium", "Carbonate", "Inorganic carbon", "Nitrate", "Nitrogen", 
             "Phosphorus", "Ammonia and ammonium", 
             "Inorganic nitrogen (nitrate and nitrite)", "Nitrite", "Orthophosphate", 
             "Kjeldahl nitrogen", "Nitrogen, mixed forms (NH3), (NH4), organic, (NO2) and (NO3)",
             "Organic Nitrogen", "Ammonia-nitrogen", "Phosphate-phosphorus",
             "Total Kjeldahl nitrogen")) %>%
  filter(ResultMeasure.MeasureUnitCode %in% c("ueq/L", "mg/l", "mg/l as N", "<NA>", "mg/l as P")) %>%
  select(MonitoringLocationIdentifier:ResultSampleFractionText,
         OrganizationIdentifier:MonitoringLocationTypeName, LatitudeMeasure, 
         LongitudeMeasure, ResultMeasureValue, ResultMeasure.MeasureUnitCode, 
         ResultStatusIdentifier) %>%
  mutate(Month = month(ActivityStartDate), 
         Year = year(ActivityStartDate)) %>%
  filter(Year >= 2015) %>%
  droplevels() %>%
  filter(!is.na(ResultMeasureValue)) %>%
  select(-SampleDepthValue, -RelativeDepth, -ResultMeasure.MeasureUnitCode) %>%
  unite("Variable", CharacteristicName:ResultSampleFractionText) 

trib_flow <- trib %>%
  filter(CharacteristicName == "Flow") %>%
           #c("Height, gage", "Stream flow, instantaneous", "Stream flow, mean. daily")) %>%
  droplevels() %>%
  #filter(ResultStatusIdentifier != "Provisional") %>% # can filter out provisional data
  select(MonitoringLocationIdentifier:ResultSampleFractionText,
         OrganizationIdentifier:MonitoringLocationTypeName, LatitudeMeasure, 
         LongitudeMeasure, ResultMeasureValue, ResultMeasure.MeasureUnitCode, 
         ResultStatusIdentifier) %>%
  select(-SampleDepthValue, -RelativeDepth, -ResultSampleFractionText, 
         -MonitoringLocationTypeName, -CharacteristicName) %>%
  group_by(MonitoringLocationIdentifier, ActivityStartDate, OrganizationIdentifier, 
           OrganizationFormalName, MonitoringLocationName, LatitudeMeasure, 
           LongitudeMeasure, ResultMeasure.MeasureUnitCode, ResultStatusIdentifier) %>%
  summarise(ResultMeasureValue = mean(ResultMeasureValue)) %>%
  mutate(Month = month(ActivityStartDate), 
         Year = year(ActivityStartDate)) %>%
  filter(Year >= 2015) %>%
  droplevels() %>%
  pivot_wider(names_from = ResultMeasure.MeasureUnitCode, values_from = ResultMeasureValue)

colnames(trib_flow)[11:14] <- c("cfs", "mgd", "g.min", "m3.sec")

# convert everything to cfs
trib_flow$mgd <- trib_flow$mgd/64317
trib_flow$g.min <- trib_flow$g.min*0.002228017
trib_flow$m3.sec <- trib_flow$m3.sec*35.3147

trib_flow_long <- trib_flow %>%
  pivot_longer(cols = c("cfs", "mgd", "g.min", "m3.sec"), 
               names_to = "orig.units", values_to = "Flow.cfs") %>%
  drop_na(Flow.cfs)

# conversions seem to match up, except Mg/d which is only used for one site.
# ggplot(trib_flow_long, aes(x = ActivityStartDate, y = Flow.cfs, color = orig.units)) +
#   geom_point(alpha = 0.5) +
#   scale_y_log10() +
#   scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.8)
```

### Find non-sampled dates

A sample type of "11" indicates a site was not sampled. A sample type of "10" indicates there was no flow. The latter should appear in the flow data as a zero; this was verified by inspecting the two datasets.

Locations and dates when sites were not sampled: 

```{r, echo = FALSE}
activitylog$Activity.Start.Date <- as.Date(activitylog$Activity.Start.Date, 
                                           "%m-%d-%Y")
activitylog_unsampled <- activitylog %>%
  filter(Activity.Start.Date > "2014-12-31") %>%
  separate(Activity.ID, into = c("SamplingRun", "MLID", "Date", "SampleType", "type"), "-") %>%
  filter(SampleType == "11") %>%
  droplevels()

unique(activitylog_unsampled$Monitoring.Location.Name)
unique(activitylog_unsampled$Activity.Start.Date)


activitylog_noflow <- activitylog %>%
  filter(Activity.Start.Date > "2014-12-31") %>%
  separate(Activity.ID, into = c("SamplingRun", "MLID", "Date", "SampleType", "type"), "-") %>%
  filter(SampleType == "10")

  
```

### Facility data

Tributary dataset was filtered for: 

1. Variables pertaining to C, N, P, or flow (discharge)
2. Years 2015-2020

Flow data were converted to cubic feet/sec (cfs) when units originally appeared as gallon/min, cubic meters/sec, and million gallons/day.

```{r, include = FALSE}
fac$datetime <- as.POSIXct(fac$datetime)
#unique(fac$CharacteristicName)

fac_wq <- fac %>%
  filter(CharacteristicName %in% 
           c("Ammonia-nitrogen as N", "Carbon", "Nitrate as N", "Organic carbon",
             "Ammonium", "Carbonate", "Inorganic carbon", "Nitrate", "Nitrogen", 
             "Phosphorus", "Ammonia and ammonium", 
             "Inorganic nitrogen (nitrate and nitrite)", "Nitrite", "Orthophosphate", 
             "Kjeldahl nitrogen", "Nitrogen, mixed forms (NH3), (NH4), organic, (NO2) and (NO3)",
             "Organic Nitrogen", "Ammonia-nitrogen", "Phosphate-phosphorus",
             "Total Kjeldahl nitrogen")) %>%
  filter(ResultMeasure.MeasureUnitCode %in% c("ueq/L", "mg/l", "mg/l as N", "<NA>", "mg/l as P")) %>%
  select(MonitoringLocationIdentifier:LongitudeMeasure, ResultMeasureValue, 
         ResultMeasure.MeasureUnitCode, ResultStatusIdentifier) %>%
  mutate(Month = month(datetime), 
         Year = year(datetime)) %>%
  filter(Year >= 2015) %>%
  droplevels() %>%
  filter(!is.na(ResultMeasureValue)) %>%
  select(-SampleDepthValue, -RelativeDepth, -ResultMeasure.MeasureUnitCode) %>%
  unite("Variable", CharacteristicName:ResultSampleFractionText) 

# match date field with trib
colnames(fac_wq)[2] <- "ActivityStartDate"


fac_flow <- fac %>%
  filter(CharacteristicName == "Flow") %>%
           #c("Height, gage", "Stream flow, instantaneous", "Stream flow, mean. daily")) %>%
  droplevels() %>%
  #filter(ResultStatusIdentifier != "Provisional") %>% # can filter out provisional data
  select(MonitoringLocationIdentifier:LongitudeMeasure, ResultMeasureValue, 
         ResultMeasure.MeasureUnitCode, ResultStatusIdentifier) %>%
  select(-SampleDepthValue, -RelativeDepth, -ResultSampleFractionText, 
         -MonitoringLocationTypeName, -CharacteristicName) %>%
  group_by(MonitoringLocationIdentifier, datetime, OrganizationIdentifier, 
           OrganizationFormalName, MonitoringLocationName, LatitudeMeasure, 
           LongitudeMeasure, ResultMeasure.MeasureUnitCode, ResultStatusIdentifier) %>%
  summarise(ResultMeasureValue = mean(ResultMeasureValue)) %>%
  mutate(Month = month(datetime), 
         Year = year(datetime)) %>%
  filter(Year >= 2015) %>%
  droplevels() %>%
  pivot_wider(names_from = ResultMeasure.MeasureUnitCode, values_from = ResultMeasureValue)

fac_flow$datetime <- as.Date(fac_flow$datetime)
colnames(fac_flow)[2] <- "ActivityStartDate"

colnames(fac_flow)[11:14] <- c("cfs", "mgd", "g.min", "m3.sec")

# convert everything to cfs
fac_flow$mgd <- fac_flow$mgd/64317
fac_flow$g.min <- fac_flow$g.min*0.002228017
fac_flow$m3.sec <- fac_flow$m3.sec*35.3147

fac_flow_long <- fac_flow %>%
  pivot_longer(cols = c("cfs", "mgd", "g.min", "m3.sec"), 
               names_to = "orig.units", values_to = "Flow.cfs") %>%
  drop_na(Flow.cfs)

```

### Combine trib and fac data

Tributary and facility water quality and flow datasets were combined.

```{r, include = FALSE}
trib_fac_wq <- rbind(trib_wq, fac_wq)
  
trib_fac_wq <- trib_fac_wq %>%
  group_by(MonitoringLocationIdentifier, ActivityStartDate, OrganizationIdentifier,
           OrganizationFormalName, MonitoringLocationName, MonitoringLocationTypeName,
           LatitudeMeasure, LongitudeMeasure, Month, Year, Variable, 
           ResultStatusIdentifier) %>%
  summarise(ResultMeasureValue = mean(ResultMeasureValue, na.rm = TRUE)) %>%
  pivot_wider(names_from = Variable, values_from = ResultMeasureValue)

colnames(trib_fac_wq)

# .d indicates dissolved, .t indicates total.
colnames(trib_fac_wq)[12:27] <- c("NH3.d", "NH3.t", "NO23.d", "NO23.t", "TDN", 
                                  "TN", "DOC", "TOC", "TDP", "TP", "PO4", 
                                  "NO3.t", "CO3.t", "TKN.d", "NO2.t", "TKN.t")

summary(trib_fac_wq)

trib_fac_flow <- rbind(trib_flow_long, fac_flow_long)

trib_fac_wq_flow <- full_join(trib_fac_wq, trib_fac_flow) 

```



### Groundwater (spring and well) data

```{r, include = FALSE}
gw_wq_flow <- gw %>%
  filter(CharacteristicName %in% 
           c("Ammonia-nitrogen as N", "Carbon", "Nitrate as N", "Organic carbon",
             "Ammonium", "Carbonate", "Inorganic carbon", "Nitrate", "Nitrogen", 
             "Phosphorus", "Ammonia and ammonium", 
             "Inorganic nitrogen (nitrate and nitrite)", "Nitrite", "Orthophosphate", 
             "Kjeldahl nitrogen", "Nitrogen, mixed forms (NH3), (NH4), organic, (NO2) and (NO3)",
             "Organic Nitrogen", "Ammonia-nitrogen", "Phosphate-phosphorus",
             "Total Kjeldahl nitrogen", 
             "Flow rate, instantaneous", "Flow", "Stream flow, instantaneous")) %>%
  droplevels() %>%
  filter(ResultMeasure.MeasureUnitCode %in% 
           c("ft3/s", "ft3/sec", "g/min", "gal/min", "m3/sec", # flow units
             "mg/l", "mg/l as N", "mg/l as P")) #%>% # chemistry units, by element not by compound
#   select(MonitoringLocationIdentifier:ResultSampleFractionText,
#          OrganizationIdentifier:MonitoringLocationTypeName, LatitudeMeasure, 
#          LongitudeMeasure, ResultMeasureValue, ResultMeasure.MeasureUnitCode, 
#          ResultStatusIdentifier) %>%
#   mutate(Month = month(ActivityStartDate), 
#          Year = year(ActivityStartDate)) %>%
#   filter(Year >= 2015) %>%
#   droplevels() %>%
#   filter(!is.na(ResultMeasureValue)) %>%
#   select(-SampleDepthValue, -RelativeDepth, -ResultMeasure.MeasureUnitCode) %>%
#   unite("Variable", CharacteristicName:ResultSampleFractionText) 
# 
# trib_flow <- trib %>%
#   filter(CharacteristicName == "Flow") %>%
#            #c("Height, gage", "Stream flow, instantaneous", "Stream flow, mean. daily")) %>%
#   droplevels() %>%
#   #filter(ResultStatusIdentifier != "Provisional") %>% # can filter out provisional data
#   select(MonitoringLocationIdentifier:ResultSampleFractionText,
#          OrganizationIdentifier:MonitoringLocationTypeName, LatitudeMeasure, 
#          LongitudeMeasure, ResultMeasureValue, ResultMeasure.MeasureUnitCode, 
#          ResultStatusIdentifier) %>%
#   select(-SampleDepthValue, -RelativeDepth, -ResultSampleFractionText, 
#          -MonitoringLocationTypeName, -CharacteristicName) %>%
#   group_by(MonitoringLocationIdentifier, ActivityStartDate, OrganizationIdentifier, 
#            OrganizationFormalName, MonitoringLocationName, LatitudeMeasure, 
#            LongitudeMeasure, ResultMeasure.MeasureUnitCode, ResultStatusIdentifier) %>%
#   summarise(ResultMeasureValue = mean(ResultMeasureValue)) %>%
#   mutate(Month = month(ActivityStartDate), 
#          Year = year(ActivityStartDate)) %>%
#   filter(Year >= 2015) %>%
#   droplevels() %>%
#   pivot_wider(names_from = ResultMeasure.MeasureUnitCode, values_from = ResultMeasureValue)

```

### Precipitation and Evapotranspiration data

TO DO: Use area vs. elevation relationship to establish average monthly lake area, with variability quantified.

REVISIT: P and ET only available 2005-2018 from EFDC output. We can only use four years of data if we restrict to 2015 onward. Should we use all years?
```{r, include= FALSE}
colnames(p_et) <- c("Date", "precip.mm", "et.mm")

p_et$Date <- as.Date(p_et$Date, origin = "1899-12-30")

p_et_monthly <- p_et %>%
  group_by(Date = floor_date(Date, unit = "1 month")) %>%
  summarise(precip.mm = sum(precip.mm), 
            et.mm = sum(et.mm)) %>%
  mutate(Year = year(Date), 
         Month = month(Date))

```


### Create spatial datasets for tributary and facility datasets

1. Intersect stations with watersheds
2. Join water quality data with intersected dataset
3. If a station is not associated with a watershed, assign it
4. Determine downstream stations in watersheds

Sites located downstream of diversion

* UTAHDWQ_WQX-4995465
* WFWQC_UT-4995467
* UTAHDWQ_WQX-4995312
* UTAHDWQ_WQX-4995578
* WFWQC_UT-4995575
* UTAHDWQ_WQX-4995578
* WFWQC_UT-4995575


Sites that may be backwatered at times

* WFWQC_UT-4917712
* WFWQC_UT-4994958
* UTAHDWQ_WQX-4995465
* WFWQC_UT-4995467
* WFWQC_UT-4996536
* UTAHDWQ_WQX-4995210
* UTAHDWQ_WQX-4995230
* WFWQC_UT-4995210
* WFWQC_UT-4995575

Intermittent sites

* UTAHDWQ_WQX-4994804
* UTAHDWQ_WQX-4994792

Sites located far from lake

* UTAHDWQ_WQX-4995312

Effluent-dominated sites

* UTAHDWQ_WQX-4996040
* WFWQC_UT-4996040

Sites included in ULWQS SAP

* UTAHDWQ_WQX-5919910
* UTAHDWQ_WQX-4994960
* UTAHDWQ_WQX-4995465
* UTAHDWQ_WQX-4994804
* UTAHDWQ_WQX-4996040
* UTAHDWQ_WQX-4996100
* UTAHDWQ_WQX-4994792
* UTAHDWQ_WQX-4994950
* UTAHDWQ_WQX-4995120
* UTAHDWQ_WQX-4996540
* UTAHDWQ_WQX-4995210
* UTAHDWQ_WQX-4995230
* UTAHDWQ_WQX-4996680
* UTAHDWQ_WQX-4995578
* UTAHDWQ_WQX-4995041
* WFWQC_UT-4995043

Items that still need to be addressed: 

* UTAHDWQ_WQX-4994792 water originates from Jordan River
* UTAHDWQ_WQX-4994950 has site at 2100 south road/stream crossing
* WFWQC_UT-4996536 represents the sum of UTAHDWQ_WQX-4996540 and UTAHDWQ_WQX-4996566
* UTAHDWQ_WQX-4995578 Located just downstream of a major diversion but above UL backwater. Flow difficult to collect at very hi flows. Look at 4995580 to supplement chemistry and flow, but for some reason I don't see this site in the list. Also look at 5919970 for flow during runoff in spring of 2020.
* UTAHDWQ_WQX-4995041 There are two outfalls from TSSD to the lake. 

REVISIT watersheds with > 2 stations: 

Powell Slough Major: 

* Powell Slough WMA North Outfall to Utah Lake (UTAHDWQ_WQX-4995210, WFWQC_UT-4995210)
* Powell Slough WMA South Outfall to Utah Lake (UTAHDWQ_WQX-4995230)

Mill Race: 

* MILL RACE CREEK AT I-15 CROSSING (2 MI S PROVO COURTHOUSE) (UTAHDWQ_WQX-4996540, WFWQC_UT-4996540)
* PROVO STATION 6-WLA (UTAHDWQ_WQX-4996566)
* Mill Race at mouth 1.25 miles west of I-15 (WFWQC_UT-4996536)

Hobble Creek: 

* HOBBLE CK AT I-15 BDG 3MI S OF PROVO (UTAHDWQ_WQX-4996100, WFWQC_UT-4996100)
* Hobble Creek at Utah Lake mouth (WFWQC_UT-4996096)

Dry Creek - Spanish Fork

* Dry Ck Near Utah Lake-WLA (UTAHDWQ_WQX-4996040, WFWQC_UT-4996040)
* DRY CK EAST TRIBUTARY (UTAHDWQ_WQX-4996042)
* Drainage Canal 0.5 mile bl I-15 at about 2500 West, Springville (UTAHDWQ_WQX-4996044)



```{r, message = FALSE, warning = FALSE, include = FALSE}

trib_fac_sites <- trib_fac_wq_flow %>% 
  ungroup() %>%
  select(MonitoringLocationIdentifier, MonitoringLocationName, 
           MonitoringLocationTypeName, LatitudeMeasure, LongitudeMeasure) %>%
  distinct() %>%
  mutate(SiteType = ifelse(MonitoringLocationTypeName %in% 
                  c("Canal Drainage", "Canal Irrigation", "Canal Transport"), "Canal", 
                ifelse(MonitoringLocationTypeName %in% c("River/Stream", "Stream", "Stream: Ditch"), "Stream",
                       ifelse(MonitoringLocationTypeName %in% c("Facility Industrial", "Facility Other"), "Facility", 
                              "Storm Sewer"))))


trib_fac_sites_sf <- st_as_sf(trib_fac_sites, coords = c("LongitudeMeasure", "LatitudeMeasure"),
                              crs = 4326, dim = "XY") #CRS = WGS84


trib_fac_sites_intersect <- trib_fac_sites_sf %>%
  st_intersection(wshds) %>%
  left_join(trib_fac_wq_flow, .,) 

unique(trib_fac_sites_intersect$MonitoringLocationName[is.na(trib_fac_sites_intersect$WS_Name)])
unique(trib_fac_sites_intersect$MonitoringLocationIdentifier[is.na(trib_fac_sites_intersect$WS_Name)])
unique(trib_fac_sites_intersect$WS_Name)

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "Powell Slough WMA North Outfall to Utah Lake"] <- "Powell Slough Major"

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "Powell Slough WMA South Outfall to Utah Lake"] <- "Powell Slough Major"

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "Dry Ck Near Utah Lake-WLA"] <- "Dry Creek - Spanish Fork"

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "Mill Race at mouth 1.25 miles west of I-15"] <- "Mill Race"  

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "Hobble Creek at Utah Lake mouth"] <- "Hobble Creek"
                                 
trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "Beer Creek at Utah Lake mouth"] <- "Benjamin Slough"

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "Lindon Drain at Utah Lake Inlet"] <- "Lindon Drain"

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "Timpanogos WWTP at Utah Lake mouth"] <- "Timp SSD"
                                   
trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "American Fork River at mouth"] <- "American Fork River"
                                
trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "Unnamed flow at 4000 West @ mouth"] <- "4000 South Drain Spanish Fork"

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "JORDAN R AT UTAH L OUTLET U121 XING"] <- "Jordan River"

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "DRY CK EAST TRIBUTARY"] <- "Dry Creek - Spanish Fork"

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "Drainage Canal 0.5 mile bl I-15 at about 2500 West, Springville"] <- "Dry Creek - Spanish Fork"

trib_fac_sites_intersect$WS_Name[trib_fac_sites_intersect$MonitoringLocationName == 
                                   "PROVO STATION 6-WLA"] <- "Mill Race"



trib_fac_sites_wsds <- trib_fac_sites_intersect %>%
  ungroup() %>%
  select(MonitoringLocationIdentifier, OrganizationIdentifier:LongitudeMeasure, 
         SiteType:Shape_Area) %>%
  distinct() %>%
  arrange(WS_Name)
# write.csv(trib_fac_sites_wsds, file = "./Data/Processed/trib_fac_sites_initial.csv",
#           row.names = FALSE)

trib_fac_sites_counts <- trib_fac_sites_intersect %>%
  ungroup() %>%
  group_by(MonitoringLocationIdentifier, OrganizationIdentifier, OrganizationFormalName,
           MonitoringLocationName, MonitoringLocationTypeName, LatitudeMeasure,
           LongitudeMeasure, SiteType, OBJECTID_1, OBJECTID, TARGET_FID,
           Type, wsa_sqkm, WS_Name, Monitored_, WS_NAME_1, WS_NAME_12, 
           Shape_Leng, Shape_Le_1, Shape_Area) %>%
  tally() %>%
  ungroup() %>%
  select(MonitoringLocationIdentifier, n)

# trib_fac_sites_SD <- read.csv("./Data/Processed/trib_fac_sites.csv")
# 
# trib_fac_sites_combined <- full_join(trib_fac_sites_SD, trib_fac_sites_counts)
# write.csv(trib_fac_sites_combined, file = "./Data/Processed/trib_fac_sites_counts.csv",
#           row.names = FALSE)

trib_fac_sites_wsds <- trib_fac_sites_wsds %>%
  full_join(., trib_fac_sites_counts)
# write.csv(trib_fac_sites_wsds, file = "./Data/Processed/trib_fac_sites_counts.csv",
#           row.names = FALSE)

trib_fac_sites_intersect_downstream <- trib_fac_sites_intersect %>%
  filter(MonitoringLocationIdentifier %in% 
           c("UTAHDWQ_WQX-4995312", # Currant Creek
             "UTAHDWQ_WQX-4995465", "WFWQC_UT-4995467", # Benjamin Slough
             "UTAHDWQ_WQX-5919910", "WFWQC_UT-4917712", # 4000 South Drain Spanish Fork
             "UTAHDWQ_WQX-4995578", "WFWQC_UT-4995575", # Spanish Fork River
             "UTAHDWQ_WQX-4996040", "WFWQC_UT-4996040", # Dry Creek - Spanish Fork
             "UTAHDWQ_WQX-4996042", "UTAHDWQ_WQX-4996044", # Dry Creek - Spanish Fork
             "WFWQC_UT-4996100", "UTAHDWQ_WQX-4996100", "WFWQC_UT-4996096", # Hobble Creek
             "WFWQC_UT-4996536", "WFWQC_UT-4996540", "UTAHDWQ_WQX-4996540", "UTAHDWQ_WQX-4996566", # Mill Race
             "WFWQC_UT-4996680", "UTAHDWQ_WQX-4996680", # Provo River
             "UTAHDWQ_WQX-4995230", "WFWQC_UT-4995210", "UTAHDWQ_WQX-4995210", # Powell Slough Major
             "WFWQC_UT-4995075", "UTAHDWQ_WQX-4995120", # Lindon Drain 
             "WFWQC_UT-4995043", "UTAHDWQ_WQX-4995041", # Timp SSD
             "WFWQC_UT-4994958", "UTAHDWQ_WQX-4994960", # American Fork River
             "WFWQC_UT-4994948", "UTAHDWQ_WQX-4994950", #Lehi Spring Creek
             "UTAHDWQ_WQX-4994804", # Dry Creek - Saratoga
             "UTAHDWQ_WQX-4994792")) %>% #Lake Mountain - Israel Canyon
  mutate(Backwater = ifelse(MonitoringLocationIdentifier %in% 
         c("WFWQC_UT-4917712", "WFWQC_UT-4994958", "UTAHDWQ_WQX-4995465", 
           "WFWQC_UT-4995467", "WFWQC_UT-4996536", "UTAHDWQ_WQX-4995210", 
           "UTAHDWQ_WQX-4995230", "WFWQC_UT-4995210", "WFWQC_UT-4995575"), 
         "Yes", "No"))
unique(trib_fac_sites_intersect_downstream$WS_Name)


# REVISIT
trib_fac_sites_intersect_downstream$SiteType[is.na(trib_fac_sites_intersect_downstream$SiteType)] <- "Unknown"

trib_fac_sites_downstream <- trib_fac_sites_intersect_downstream %>% 
  ungroup() %>%
  select(MonitoringLocationIdentifier, MonitoringLocationName, OrganizationIdentifier,
           MonitoringLocationTypeName, LatitudeMeasure, LongitudeMeasure, WS_Name) %>%
  distinct()


trib_fac_sites_downstream_sf <- st_as_sf(trib_fac_sites_downstream, coords = c("LongitudeMeasure", "LatitudeMeasure"),
                              crs = 4326, dim = "XY") #CRS = WGS84

trib_fac_sites_downstream_sf$WS_Name <- 
  factor(trib_fac_sites_downstream_sf$WS_Name, 
         levels = c("Lake Mountain - Israel Canyon", "Dry Creek - Saratoga", 
                    "Lehi Spring Creek", "American Fork River", "Timp SSD", 
                    "Lindon Drain", "Powell Slough Major", "Provo River", 
                    "Mill Race", "Hobble Creek", "Dry Creek - Spanish Fork",
                    "Spanish Fork River", "4000 South Drain Spanish Fork",
                    "Benjamin Slough", "Currant Creek"))
                                                                                                                      
trib_fac_sites_intersect_downstream$WS_Name <- 
  factor(trib_fac_sites_intersect_downstream$WS_Name, 
         levels = c("Lake Mountain - Israel Canyon", "Dry Creek - Saratoga", 
                    "Lehi Spring Creek", "American Fork River", "Timp SSD", 
                    "Lindon Drain", "Powell Slough Major", "Provo River", 
                    "Mill Race", "Hobble Creek", "Dry Creek - Spanish Fork",
                    "Spanish Fork River", "4000 South Drain Spanish Fork",
                    "Benjamin Slough", "Currant Creek"))          
```

## Visualization
### Maps

The top graph depicts all tributary and facility monitoring sites. The second graph depicts each monitored watershed individually from the NW side of the lake moving clockwise, with downstream monitoring sites marked. The third graph depicts all watersheds with only downstream monitoring sites marked.

```{r, fig.height = 8, fig.width = 8, echo = FALSE, message = FALSE}
ggplot(wshds) +
  geom_sf(aes(fill = Monitored_)) +
  geom_sf(data = trib_fac_sites_sf, aes(color = SiteType),
          alpha = 0.5) +
  scale_color_viridis_d(option = "magma", end = 0.8, direction = -1) +
  scale_fill_manual(values = c("darkgray", "lightgray"))

# ggplot(wshds_monitored) +
#   geom_sf() +
#   geom_sf(data = trib_fac_sites_downstream_sf, aes(color = OrganizationIdentifier)) +
#   facet_wrap(~WS_Name, nrow = 3) +
#   theme(legend.position = "top")

# tm_shape(wshds_monitored) +
#   tm_polygons("wsa_sqkm")  +
#   tm_facets(by = "WS_Name")

map.grid <- purrr::map(wshds_monitored$WS_Name,
           function(x) {
             ggplot(data = filter(wshds_monitored, WS_Name == x)) +
               geom_sf() +
               geom_sf(data = filter(trib_fac_sites_downstream_sf, WS_Name == x),
                       aes(color = OrganizationIdentifier)) +
               scale_color_viridis_d(option = "magma", end = 0.8, begin = 0.2, direction = -1) +
               scale_x_continuous() +
               theme(legend.position = "none", title = element_text(size = 8),
                     axis.text = element_blank(), axis.ticks = element_blank()) +
               labs(title = x)
           })
plot_grid(map.grid[[15]], map.grid[[5]], map.grid[[4]], map.grid[[6]], map.grid[[7]],
          map.grid[[8]], map.grid[[1]], map.grid[[9]], map.grid[[10]], map.grid[[12]],
          map.grid[[11]], map.grid[[13]], map.grid[[3]], map.grid[[2]], map.grid[[14]],
          nrow = 3)

ggplot(wshds) +
  geom_sf(aes(fill = Monitored_)) +
  geom_sf(data = trib_fac_sites_downstream_sf, aes(color = OrganizationIdentifier)) +
  labs(fill = "Monitored", color = "Organization") +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  scale_fill_manual(values = c("darkgray", "lightgray")) +
  theme(legend.position = "top")

```


### Water Quality Time Series
```{r, echo = FALSE, message = FALSE, warning = FALSE}
# TN
ggplot(trib_fac_sites_intersect_downstream, aes(x = ActivityStartDate, y = TN, shape = SiteType,
                                                color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3) +
  scale_y_log10() +
  labs(x = "", y = "TN (mg/L)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")
  
# TDN
ggplot(trib_fac_sites_intersect_downstream, aes(x = ActivityStartDate, y = TDN, shape = SiteType,
                                                color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3) +
  scale_y_log10() +
  labs(x = "", y = "TDN (mg/L)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

# TP
ggplot(trib_fac_sites_intersect_downstream, aes(x = ActivityStartDate, y = TP, shape = SiteType,
                                                color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3) +
  scale_y_log10() +
  labs(x = "", y = "TP (mg/L)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

# TDP
ggplot(trib_fac_sites_intersect_downstream, aes(x = ActivityStartDate, y = TDP, shape = SiteType,
                                                color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3) +
  scale_y_log10() +
  labs(x = "", y = "TDP (mg/L)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

# TOC
ggplot(trib_fac_sites_intersect_downstream, aes(x = ActivityStartDate, y = TOC, shape = SiteType,
                                                color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3) +
  scale_y_log10() +
  labs(x = "", y = "TOC (mg/L)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

# DOC
ggplot(trib_fac_sites_intersect_downstream, aes(x = ActivityStartDate, y = DOC, shape = SiteType,
                                                color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3) +
  scale_y_log10() +
  labs(x = "", y = "DOC (mg/L)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

```


### Water quality by month

```{r, include = FALSE}
# code to generate sample sizes 
give.n <- function(x){
   return(c(y = (max(x) + 0.2*(max(x))), label = length(x)))
}
```

Lake Mountain - Israel Canyon

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lake Mountain - Israel Canyon"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lake Mountain - Israel Canyon"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lake Mountain - Israel Canyon"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lake Mountain - Israel Canyon"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lake Mountain - Israel Canyon"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lake Mountain - Israel Canyon"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

Dry Creek - Saratoga

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

Lehi Spring Creek

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

American Fork River

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

Timp SSD

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Timp SSD"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Timp SSD"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Timp SSD"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Timp SSD"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Timp SSD"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Timp SSD"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

Lindon Drain

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

Powell Slough Major

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

Provo River

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

Mill Race

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

Hobble Creek

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

Dry Creek - Spanish Fork

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

Spanish Fork River

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

4000 South Drain Spanish Fork

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#62197d", "#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#62197d", "#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#62197d", "#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

Benjamin Slough

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

Currant Creek

```{r, echo = FALSE, message = FALSE, warning = FALSE}
TN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = TN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDN <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = TDN, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDN (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = TP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TDP <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = TDP, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TDP (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none", 
        axis.title.x = element_blank(), axis.text.x = element_blank())

TOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = TOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "TOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

DOC <-
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = DOC, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "DOC (mg/L)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "none")

legend <- get_legend(TN + guides(fill = guide_legend(nrow = 1)) + 
                     theme(legend.position = "top"))

CNP <-
plot_grid(TN, TDN, TP, TDP, TOC, DOC, 
          nrow = 3, align = "hv")

plot_grid(legend, CNP, ncol = 1, rel_heights = c(0.1, 1))
```

### Flow time series
```{r, echo = FALSE, message = FALSE, warning = FALSE}
ggplot(trib_fac_sites_intersect_downstream, 
       aes(x = ActivityStartDate, y = Flow.cfs, shape = SiteType, 
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3) +
  scale_y_log10() +
  labs(x = "", y = "Flow (cfs)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")
```

### Flow by month

Lake Mountain - Israel Canyon

```{r, echo = FALSE, message = FALSE, warning = FALSE}
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lake Mountain - Israel Canyon"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
```

Dry Creek - Saratoga

```{r, echo = FALSE, message = FALSE, warning = FALSE}
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Saratoga"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
```

Lehi Spring Creek

```{r, echo = FALSE, message = FALSE, warning = FALSE}
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lehi Spring Creek"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
```

American Fork River

```{r, echo = FALSE, message = FALSE, warning = FALSE}
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "American Fork River"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site") +
  # scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
```

Timp SSD

```{r, echo = FALSE, message = FALSE, warning = FALSE}
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Timp SSD"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
```

Lindon Drain

```{r, echo = FALSE, message = FALSE, warning = FALSE}
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Lindon Drain"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
```

Powell Slough Major

```{r, echo = FALSE, message = FALSE, warning = FALSE}
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Powell Slough Major"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
```

Provo River

```{r, echo = FALSE, message = FALSE, warning = FALSE}
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Provo River"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
```

Mill Race

```{r, echo = FALSE, message = FALSE, warning = FALSE}
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Mill Race"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#db4a69", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top") +
  guides(fill = guide_legend(ncol = 2))
```

Hobble Creek

```{r, echo = FALSE, message = FALSE, warning = FALSE}
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Hobble Creek"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#8a2880", "#3b1165")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
```

Dry Creek - Spanish Fork

```{r, echo = FALSE, message = FALSE, warning = FALSE}
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Dry Creek - Spanish Fork"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site") +
  scale_fill_manual(values = c("#fc9d6f", "#f27162", "#db4a69", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top") +
  guides(fill = guide_legend(ncol = 2))
```

Spanish Fork River

```{r, echo = FALSE, message = FALSE, warning = FALSE}
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Spanish Fork River"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
```

4000 South Drain Spanish Fork

```{r, echo = FALSE, message = FALSE, warning = FALSE}
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "4000 South Drain Spanish Fork"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site") +
  scale_fill_manual(values = c("#62197d", "#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
```

Benjamin Slough

```{r, echo = FALSE, message = FALSE, warning = FALSE}
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Benjamin Slough"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3,
                  position = position_dodge(width = 0.75)) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site") +
  scale_fill_manual(values = c("#f27162", "#62197d")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
```

Currant Creek

```{r, echo = FALSE, message = FALSE, warning = FALSE}
ggplot(subset(trib_fac_sites_intersect_downstream, WS_Name == "Currant Creek"),
       aes(x = as.factor(Month), y = Flow.cfs, fill = MonitoringLocationIdentifier, 
           color = Backwater)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.8) +
  stat_summary(fun.data = give.n, geom = "text", size = 3) +
  labs(x = "Month", y = "Flow (cfs)", fill = "Site") +
  scale_fill_manual(values = c("#f27162")) +
  scale_color_manual(values = c("black", "gray"), guide = "none") +
  theme(legend.position = "top")
```


### C-Q

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# TN
ggplot(trib_fac_sites_intersect_downstream, 
       aes(x = Flow.cfs, y = TN, shape = SiteType, 
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3) +
  scale_x_log10() +
  scale_y_log10() +
  labs(x = "Flow (cfs)", y = "TN (mg/L)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

# TDN
ggplot(trib_fac_sites_intersect_downstream, 
       aes(x = Flow.cfs, y = TDN, shape = SiteType, 
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3) +
  scale_x_log10() +
  scale_y_log10() +
  labs(x = "Flow (cfs)", y = "TDN (mg/L)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

# TP
ggplot(trib_fac_sites_intersect_downstream, 
       aes(x = Flow.cfs, y = TP, shape = SiteType, 
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3) +
  scale_x_log10() +
  scale_y_log10() +
  labs(x = "Flow (cfs)", y = "TP (mg/L)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

# TDP
ggplot(trib_fac_sites_intersect_downstream, 
       aes(x = Flow.cfs, y = TDP, shape = SiteType, 
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3) +
  scale_x_log10() +
  scale_y_log10() +
  labs(x = "Flow (cfs)", y = "TDP (mg/L)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

# TOC
ggplot(trib_fac_sites_intersect_downstream, 
       aes(x = Flow.cfs, y = TOC, shape = SiteType, 
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3) +
  scale_x_log10() +
  scale_y_log10() +
  labs(x = "Flow (cfs)", y = "TOC (mg/L)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

# DOC
ggplot(trib_fac_sites_intersect_downstream, 
       aes(x = Flow.cfs, y = DOC, shape = SiteType, 
           color = OrganizationIdentifier)) +
  geom_point(alpha = 0.7, size = 2) +
  facet_wrap(vars(WS_Name), ncol = 3) +
  scale_x_log10() +
  scale_y_log10() +
  labs(x = "Flow (cfs)", y = "DOC (mg/L)", shape = "Site Type", color = "Organization") +
  scale_shape_manual(values = c(15, 16, 17, 18)) +
  scale_color_viridis_d(option = "magma", begin = 0.2, end = 0.7, direction = -1) +
  theme(legend.position = "top")

```

### Precipitation and evaporation

TO DO: Change y axis to volumes after determining monthly lake area

```{r, echo = FALSE, message = FALSE, warning = FALSE, width = 5, height = 4}
ggplot(p_et_monthly, aes(x = Date, y = precip.mm)) +
  geom_point() +
  geom_line() +
  labs(y = "Monthly precipitation (mm)")

ggplot(p_et_monthly, aes(x = Date, y = et.mm)) +
  geom_point() +
  geom_line() +
  labs(y = "Monthly evaporation (mm)")

ggplot(p_et_monthly, aes(x = as.factor(Month), y = precip.mm)) +
  geom_boxplot() +
  geom_jitter(aes(color = as.factor(Year)), width = 0.15, alpha = 0.8) +
  labs(y = "Monthly precipitation (mm)") +
  scale_color_viridis_d(option = "magma", end = 0.8)

ggplot(p_et_monthly, aes(x = as.factor(Month), y = et.mm)) +
  geom_boxplot() +
  geom_jitter(aes(color = as.factor(Year)), width = 0.15, alpha = 0.8) +
  labs(y = "Monthly evaporation (mm)") +
  scale_color_viridis_d(option = "magma", end = 0.8)

```


## Spare code

```{r, include = FALSE}
DmrFac <- read.csv("./Data/Processed/DmrFacilityInfo.csv")

Dmr_Sp <- st_as_sf(DmrFac,coords = c("dec_long", "dec_lat"),crs=4236)


```

